//kodmunki utilities
(function(k){if(!k){k={}}k.isArray=function(L){return L instanceof Array};k.isBool=function(L){return(/boolean/i.test(typeof(L)))};k.isDate=function(L){return L instanceof Date};k.isEm=function(L){return(/\d+em/i.test(L))};k.isEvent=function(L){try{return L instanceof Event}catch(M){return L===window.event}};k.isNumber=function(L){return(/number/i.test(typeof(L)))&&!isNaN(L)};k.isObject=function(L){return k.exists(L)&&(/object/i.test(typeof(L)))};k.isFunction=function(L){return(L instanceof Function)};k.isPercent=function(L){return(/\d+%/.test(L))};k.isPixel=function(L){return(/\d+px/.test(L))};k.isString=function(L){return(/string/i.test(typeof(L)))||L instanceof String};k.isZero=function(L){return L===0};k.isEven=function(L){return(k.isNullOrEmpty(L)||k.isDate(L))?false:(isNaN(L)?false:(k.isZero(L)?false:L%2===0))};k.isOdd=function(L){return(k.isNullOrEmpty(L)||k.isDate(L))?false:(isNaN(L)?false:(k.isZero(L)?false:!k.isEven(L)))};k.isNull=function(L){return L===null};k.isUndefined=function(L){return(/undefined/i.test(typeof(L)))};k.isEmpty=function(L){return k.isString(L)&&k.isZero(L.split(/\B/).length)};k.isNullOrEmpty=function(L){return !k.exists(L)||k.isEmpty(L)};k.exists=function(L){return(L!==null)&&(!k.isUndefined(L))};k.xor=function(M,L){return !M!=!L};k.isDecendentOf=function(N,O){var M=k.ele(N),L=k.ele(O);if((!M||!L)||(M==L)){return false}do{if(M==L){return true}}while(M=M.parentNode);return false};k.ext=function(M,L){if(!M||!L){return null}var N=function(){};N.prototype=L.prototype;M.base=L;M.prototype=k.obj.merge(M.prototype,new N());M.prototype.constructor=M;return M};k.math={round:function(O,N){var M=N||0,L=Math.pow(10,-M);return Math.round(parseFloat((O*L).toFixed(Math.abs(M))))/L},roundUp:function(O,N){var M=N||0,L=5*(Math.pow(10,M-1));return k.math.round(O+L,N)},roundDown:function(O,N){var M=N||0,L=5*(Math.pow(10,M-1));return k.math.round(O-L,N)},factorial:function(N){var L=N,M=N;while(M--){if(!!M){L*=M}}return L},divide:function(M,L){var N=k.isNumber(M)&&k.isNumber(L)&&!k.isZero(L);if(!N){throw new Error(k.str.format("Invalid division. value: {0}/{1} | type: {2}/{3}",M,L,typeof M,typeof L))}return M/L}};k.obj={keys:function(M){var L=[];for(n in M){L[L.length]=n}return L},values:function(M){var L=[];for(n in M){L[L.length]=M[n]}return L},count:function(L){var M=0;for(n in L){M++}return M},hasProp:function(L,M){return(k.exists(L.hasOwnProperty))?L.hasOwnProperty(M):false},merge:function(M,L){var N=k.replicate(L);for(n in M){N[n]=M[n]}return N},meld:function(N,M){var L=k.replicate(M);for(n in N){if(k.exists(L[n])){continue}L[n]=N[n]}return L}};k.replicate=function(N){var L=(k.isDate(N))?new Date(N):(k.isArray(N))?[]:(k.isObject(N))?{}:N,M;for(n in N){M=N[n];L[n]=((k.isArray(M))||(k.isObject(M)))?k.replicate(M):M}return L};k.str={build:function(){return"".concat.apply(new String(),arguments)},format:function(){var N=arguments,P=N[0],M=N.length,L,O;for(i=1;i<M;i++){L=N[i];O=(k.isNull(L))?"null":(k.isUndefined(L))?"undefined":L.toString();P=P.replace(RegExp("\\{"+(i-1)+"\\}","g"),O)}return P},parse:function(){return String.fromCharCode.apply(String,arguments)},trim:function(L){return k.str.trimStart(k.str.trimEnd(L))},trimStart:function(L){if(!k.isString(L)){throw new Error("Cannot trim non-string values")}return(k.exists(L.replace))?L.replace(/^\s*\b/,""):L},trimEnd:function(L){if(!k.isString(L)){throw new Error("Cannot trim non-string values")}return(k.exists(L.replace))?L.replace(/\b\s*$/,""):L}};k.uid=function(N){var M=N||"kuid",L=Math.random().toString().replace(/\b\.\b/,"");return k.str.format("{0}{1}",M,L)};kodmunki={};k.Class=function(){};k.Class.prototype={get:function(L){return this["_"+L]},set:function(M,L){this["_"+M]=L;return this},property:function(M,L){return(k.isUndefined(L))?this.get(M):this.set(M,L)}};function e(L){e.base.call(this);var M=(!k.exists(L)||!L.toObject)?L:L.toObject();this.$h=(k.exists(M))?M:{};this._count=0;for(n in this.$h){this._count++}}e.prototype={count:function(){return this.get("count")},add:function(M,L){if(!k.exists(M)||this.containsKey(M)){return this}this.$h[M]=L;this._count++;return this},clear:function(){var L=this.$h;for(n in L){delete L[n]}this._count=0;return this},find:function(L){if(!k.exists(L)){return null}return this.$h[L]},findKey:function(L){if(!k.exists(L)){return null}var M=this.$h;for(n in M){if(M[n]==L){return n}}return null},findValue:function(L){return this.find(L)},quit:function(){this._iterator.quit();return this},each:function(M,L){var N=L||this;this._iterator=k.iterator(this.toObject());this._iterator.each(M,N);return this},isEmpty:function(){return this._count<1},listKeys:function(){return new k.list(k.obj.keys(this.$h))},listValues:function(){return new k.list(k.obj.values(this.$h))},containsKey:function(L){if(!k.exists(L)){return false}return k.exists(this.$h[L])},containsValue:function(M){var L=k.obj.values(this.$h),N=L.length;while(N--){if(L[N]==M){return true}}return false},merge:function(L){return A(this,L,"merge")},meld:function(L){return A(this,L,"meld")},remove:function(L){var M=this.$h;if(!k.exists(L)||!k.exists(M[L])){return this}delete M[L];this._count--;return this},replicate:function(){return k.hash(k.replicate(this.$h))},toObject:function(){return this.$h},update:function(M,L){if(!k.exists(M)){return this}if(!this.containsKey(M)){this._count++}this.$h[M]=L;return this}};k.ext(e,k.Class);function A(N,M,L){var O=(!M.toObject)?M:M.toObject();N.$h=k.obj[L](O,N.$h);N._count=k.obj.count(N.$h);return N}k.hash=function(L){return new e(L)};k.hash.Class=e;function H(M){H.base.call(this);this._keys=[];this._hash=k.hash();this._count=this._keys.length;if(!k.exists(M)){return}var N=0,L=M.length;while(N<L){this.add(M[N]);N++}}H.prototype={count:function(){return this.get("count")},add:function(M){var L=this._keys,N=k.uid();L[L.length]=N;this._hash.add(N,M);this._count=this._keys.length;return this},clear:function(){this._hash.clear();this._keys=[];this._count=this._keys.length;return this},contains:function(L){return this._hash.containsValue(L)},find:function(M){var L=this._keys;return(k.exists(L[M]))?this._hash.find(L[M]):null},quit:function(){this._iterator.quit();return this},each:function(M,L){var N=L||this;this._iterator=k.iterator(this.toArray());this._iterator.each(M,N);return this},isEmpty:function(){return this._count<1},remove:function(N){var M=this._hash,L;if(!this.contains(N)){return this}L=M.findKey(N);this._keys.splice(L,1);M.remove(L);this._count=M.count();return this},toArray:function(){var L=[];this._hash.each(function(M){L.push(M.value)});return L}};k.ext(H,k.Class);k.list=function(L){return new H(L)};k.list.Class=H;k.list.parseArguments=function(L){return new H(Array.prototype.slice.call(L))};function K(L){K.base.call(this);this._isLocked=L||false}K.prototype={isLocked:function(){return this.get("isLocked")},lock:function(){this._isLocked=true},unlock:function(){this._isLocked=false}};k.ext(K,k.Class);k.lock=function(L){return new K(L)};k.lock.Class=K;var v=function(N,O,L,M){this._type=N;this._info=O||"";this._browserTrace=L;this._ku4jTrace=M};v.prototype={message:"",type:function(){return this._type},info:function(){return this._info},browserTrace:function(){return this._browserTrace},ku4jTrace:function(){return this._ku4jTrace},toString:function(){var L="EXCEPTION: {0}: {1}\n\nBowser stack trace:\n{2}\n\nku4j stack:\n{3}";return k.str.format(L,this._type,this._info,this._browserTrace,this._ku4jTrace)},toObject:function(){return{type:this._type,message:this._info,browserTrace:this._browserTrace,ku4jTrace:this._ku4jTrace}}};k.kulog=function(){try{console.log.apply(console,arguments)}catch(L){alert(Array.prototype.slice.call(arguments).join("\n"))}};k.refcheck=function(M,L){if(!k.exists(M)){throw k.exception("null",L)}return M};k.exception=function(P,R){var O={generic:{type:"GENERIC EXCEPTION",message:'Generic exeption. Use $.exeption("[null|arg]") for more detail.'},operation:{type:"OPERATION EXCEPTION",message:"Invalid operation."},"null":{type:"REFERENCE EXCEPTION",message:"Invalid reference to type null or undefined."},arg:{type:"ARGUMENT EXCEPTION",message:"Invalid argument"}},M=arguments.callee.caller,N="",L="",Q=(k.exists(O[P]))?O[P]:O.generic,S=(k.exists(R))?" - "+R:"";(function(){try{generate.exeception}catch(V){L=(k.exists(V.stack))?V.stack.replace(/generate is.+/,""):"[Unavailable]";var U=0,W,T;while(M&&(U<10)){W=M.toString().replace(/[\n\t\r\s]+/g," ").substring(0,100);T=W.replace(/\W/g,"a").replace(/\s/g,"").replace(/.*base\.js:216/,"").split(/\B/).length>99?W+"...":W;N+=k.str.format("<kuidx[{0}]>:{1}\n",U,T);M=M.caller;U++}}})();return new v(Q.type,Q.message+S,L,N)};k.abstractContext=function(L){k.abstractContext.base.call(this);this.state(L)};k.abstractContext.prototype={state:function(L){if(!k.exists(L)){return this._state}return this.set("state",L.context(this))}};k.ext(k.abstractContext,k.Class);k.abstractState=function(L){k.abstractState.base.call(this);this.states(L)};k.abstractState.prototype={context:function(L){return this.property("context",L)},states:function(L){return this.set("states",L)},state:function(L){var M=this._context;M.state(new this._states[L](M));return this}};k.ext(k.abstractState,k.Class);k.abstractVisitor=function(){};k.abstractVisitor.prototype={$visit:function(){throw new Error("visit method is abstract an must be defined.")},subject:function(L){return this.property("subject",k.replicate(L))},visit:function(){return this.$visit()}};function B(L){B.base.call(this);this.$current=0;this._quit=false;this.subject(L)}B.prototype={$hasNext:function(){return k.exists(this._subject[this.$current+1])},$hasPrev:function(){return k.exists(this._subject[this.$current-1])},$each:function(M,N){var L=N||this;this.reset();do{M.call(L,this.current())}while(this.next()&&(!this._quit));this._end=false;this.reset()},$exec:function(N){var L=this._subject,M=L[N];if(!k.exists(M)){return null}this.$current=N;return M},subject:function(M){var L=(k.isArray(M))?M:(k.isObject(M))?I(M):M;if(!k.isUndefined(M)){this.reset()}this.$subject=L;return this.property("subject",L)},current:function(){return this.$exec(this.$current)},next:function(){return this.$exec(this.$current+1)},prev:function(){return this.$exec(this.$current-1)},hasNext:function(){return this.$hasNext()},hasPrev:function(){return this.$hasPrev()},reset:function(){this.$current=0;return this},quit:function(){return this.set("quit",true)},each:function(L,M){if(this._subject.length<1){return this}this.$each(L,M);return this}};function I(L){var M=[];for(n in L){M.push({key:n,value:L[n]})}return M}k.ext(B,k.Class);k.iterator=function(L){return new B(L)};k.iterator.Class=B;function w(){w.base.call(this);this._observers=new k.hash()}w.prototype={subscribe:function(L,P,M,O){var N=this._observers;if(N.containsKey(L)){N.find(L).add(P,M,O)}else{N.add(L,k.observer().add(P,M,O))}return this},unsubscribe:function(L,N){var M=this._observers;if(M.containsKey(L)){M.find(L).remove(N)}return this},notify:function(){var O=k.list.parseArguments(arguments),L=O.find(0),N=!this._observers.containsKey(L),M=!N||(O.count()>1),P=N?L:null,Q=O.remove(0);return(M)?this._notify(P,Q):this._notifyAll(P);return this},clear:function(){this._observers.each(function(L){L.value.clear()}).clear();return this},isEmpty:function(){return this._observers.isEmpty()},_notifyAll:function(L){this._observers.listValues().each(function(M){M.notify(L)});return this},_notify:function(M,L){var N=this._observers;L.each(function(O){try{N.find(O).notify(M)}catch(P){return}});return this}};k.ext(w,k.Class);k.mediator=function(){return new w()};k.mediator.Class=w;function F(){F.base.call(this);this._methods=new k.hash()}F.prototype={add:function(P,M,O){var L=O||k.uid("observerMethod"),N=M||this;this._methods.add(L,{m:P,s:N});return this},remove:function(L){this._methods.remove(L);return this},clear:function(){this._methods.clear();return this},notify:function(){var M=new k.iterator(this._methods.listValues().toArray()),L=arguments;M.each(function(N){k.refcheck(N.m).apply(N.s,L)});return this},isEmpty:function(){return this._methods.isEmpty()}};k.ext(F,k.Class);k.observer=function(){return new F()};k.observer.Class=F;function d(L){d.base.call(this,L)}d.prototype={$hasNext:function(){var N=this.$subject,L=N.length-1,P=this.$current,O=P+1,M=(O>L)?0:O;return k.exists(N[M])},$hasPrev:function(){var N=this.$subject,L=N.length-1,P=this.$current,O=P+1,M=(O<0)?L:O;return k.exists(N[M])},$each:function(M,N){var L=N||this;this.reset();do{M.call(N,this.current())}while(this.next()&&(this.$current>0));this.reset()},$exec:function(N){var M=this.$subject,L=(M.length-1);this.$current=(N>L)?0:((N<0)?L:N);return M[this.$current]}};k.ext(d,k.iterator.Class);k.rolodex=function(L){return new d(L)};k.rolodex.Class=d;function E(L){this._strategy=L}E.prototype={sort:function(L){return this.$sort(L,this._strategy)},strategy:{asc:function(M,L){var O=this._findSortValue(M),N=this._findSortValue(L);if(!isNaN(O)&&!isNaN(N)){return(O-N)}return((O>N)||!isNaN(N))?1:((O<N)||!isNaN(O))?-1:0},des:function(M,L){var O=this._findSortValue(M),N=this._findSortValue(L);if(!isNaN(O)&&!isNaN(N)){return(N-O)}return((O<N)||!isNaN(O))?1:((O>N)||!isNaN(N))?-1:0}},$sort:function(L,N){var M=this;return L.sort(function(P,O){return N.apply(M,arguments)})},_findSortValue:function(M){var L=(k.exists(M.getValue))?M.getValue():(k.exists(M.value))?M.value:(k.exists(M.nodeName))?k.getText(M):M;if(k.isString(L)){if(L.indexOf("$")!=-1){return k.money.parse(L).value}if(/\d{1,2}\/\d{1,2}\/(\d{2}|\d{2,4})/.test(L)){return new Date(L)}if(/\d{3}-\d{2}-\d{4}/.test(L)){return k.ssn.parse(L)}if(L.indexOf(".")!=-1&&!isNaN(parseFloat(L))){return parseFloat(L)}if(L.search(/([a-z]|[A-Z])+/)==-1&&!isNaN(parseInt(L))){return parseInt(L)}}return L}};function J(){}J.prototype={$isSatisfiedBy:function(L){return},isSatisfiedBy:function(L){return this.$isSatisfiedBy(L)},and:function(L){return new y(this,L)},or:function(L){return new z(this,L)},xor:function(L){return new G(this,L)},not:function(){return new g(this)}};function y(M,L){y.base.call(this);this.$1=M;this.$2=L}y.prototype.$isSatisfiedBy=function(L){return this.$1.isSatisfiedBy(L)&&this.$2.isSatisfiedBy(L)};k.ext(y,J);function z(M,L){z.base.call(this);this.$1=M;this.$2=L}z.prototype.$isSatisfiedBy=function(L){return this.$1.isSatisfiedBy(L)||this.$2.isSatisfiedBy(L)};k.ext(z,J);function G(M,L){G.base.call(this);this.$1=M;this.$2=L}G.prototype.$isSatisfiedBy=function(L){return k.xor(this.$1.isSatisfiedBy(L),this.$2.isSatisfiedBy(L))};k.ext(G,J);function u(){u.base.call(this)}u.prototype.$isSatisfiedBy=function(L){return true};k.ext(u,J);function a(){a.base.call(this)}a.prototype.$isSatisfiedBy=function(L){return false};k.ext(a,J);function g(L){g.base.call(this);this._s=L}g.prototype.$isSatisfiedBy=function(L){return !this._s.isSatisfiedBy(L)};k.ext(g,J);function q(L){q.base.call(this);this.$isSatisfiedBy=L}k.ext(q,J);k.spec=function(L){return new q(L)};function o(){o.base.call(this);this.value}o.prototype={context:function(L){return this.property("context",L)},invoke:function(L){L.toggle()}};k.ext(o,k.Class);function h(){h.base.call(this);this.value}h.prototype={context:function(L){return this.property("context",L)},invoke:function(L){var M=this.context();M.each(function(O){var N=(O===L);O.isActive(N)})}};k.ext(h,k.Class);function D(){D.base.call(this);this._onActive=k.observer();this._onInactive=k.observer();this._isActive=false}D.prototype={value:function(L){return this.property("value",L)},toggleset:function(L){return this.property("toggleset",L)},isActive:function(L){if(k.exists(L)){if(L){this._onActive.notify()}else{this._onInactive.notify()}}return this.property("isActive",L)},toggle:function(){return this.isActive(!this.isActive())},invoke:function(){var L=this._toggleset;if(k.exists(L)){L.invoke(this)}else{this.toggle()}return this},onActive:function(M,L){this._onActive.add(M,L);return this},onInactive:function(M,L){this._onInactive.add(M,L);return this}};k.ext(D,k.Class);k.toggle=function(){return new D()};k.toggle.Class=D;function r(){r.base.call(this);this._toggles=k.list();this._onInvoke=k.observer();this.multipleSelect()}r.prototype={isEmpty:function(){return this._toggles.isEmpty()},strategy:function(L){if(k.exists(L)){L.context(this)}return this.property("strategy",L)},multipleSelect:function(){return this.strategy(new o())},mutuallyExclusive:function(){return this.strategy(new h())},invoke:function(L){this.strategy().invoke(L);return this},add:function(L){this._toggles.add(L.toggleset(this));return this},remove:function(L){this._toggles.remove(L);return this},onInvoke:function(M,L,N){this._onInvoke.add(M,L,N);return this},each:function(M,L){this._toggles.each(M,L);return this}};k.ext(r,k.Class);k.toggleset=function(){return new r()};k.toggleset.Class=r;function x(){}x.prototype={profile:function(O,L){var M=1000,N=(new Date()).getTime();while(M--){O.apply(O,L)}return((new Date()).getTime()-N)/1000}};k.profiler=function(){return new x()}})($);(function(o){if(!o){o={}}function B(L,K,J){function M(N){var O=parseInt(N);if(!(o.isNumber(O)&&O>=0&&O<=255)){throw o.exception("arg",o.str.format("at $.color({0},{1},{2})",L,K,J))}return O}this._red=M(L);this._green=M(K);this._blue=M(J)}B.prototype={red:function(){return this._red},green:function(){return this._green},blue:function(){return this._blue},add:function(K){function L(O){return(O>255)?255:O}var N=L(this.red()+K.red()),M=L(this.green()+K.green()),J=L(this.blue()+K.blue());return o.color(N,M,J)},subtract:function(K){function L(O){return Math.abs(O)}var N=L(this.red()-K.red()),M=L(this.green()-K.green()),J=L(this.blue()-K.blue());return o.color(N,M,J)},multiply:function(K){function L(O){return(O>255)?255:O}var N=L(this.red()*K.red()),M=L(this.green()*K.green()),J=L(this.blue()*K.blue());return o.color(N,M,J)},divide:function(K){function L(O){return isNaN(O)?0:O}var N=L(this.red()/K.red()),M=L(this.green()/K.green()),J=L(this.blue()/K.blue());return o.color(N,M,J)},and:function(K){function L(O){return isNaN(O)?0:O}var N=L(this.red()&&K.red()),M=L(this.green()&&K.green()),J=L(this.blue()&&K.blue());return o.color(N,M,J)},or:function(K){function L(O){return isNaN(O)?0:O}var N=L(this.red()||K.red()),M=L(this.green()||K.green()),J=L(this.blue()||K.blue());return o.color(N,M,J)},mix:function(J){function K(N,M){var L=parseInt(N+(Math.abs(N-M)/2));return L>255?255:L<0?0:L}return o.color(K(this.red(),J.red()),K(this.green(),J.green()),K(this.blue(),J.blue()))},equals:function(J){return(this.red()==J.red())&&(this.green()==J.green())&&(this.blue()==J.blue())},toHex:function(L){function J(M){var N=(new Number(M)).toString(16),O=/[\dA-F]{2}/i.test(N)?N:"0"+N;return O}var K=L||"0x";return o.str.format("{0}{1}{2}{3}",K,J(this.red()),J(this.green()),J(this.blue()))},toCSS:function(){return this.toHex("#")},toRGB:function(){return o.str.format("rgb({0},{1},{2})",this.red(),this.green(),this.blue())},toNumber:function(){return parseInt(this.toHex())}};o.ext(B,o.Class);o.color=function(L,K,J){return new B(L,K,J)};o.color.canParse=function(J){if(o.isString(J)&&/\D/.test(J)){return/^[#(0x)][\dA-F]{6}$/i.test(J)||/^rgb\(\d{1,3}\,\s?\d{1,3}\,\s?\d{1,3}\)$/i.test(J)}var K=parseInt(J);return o.isNumber(K)&&K>=0&&K<=16777215},o.color.parse=function(J){if(J instanceof B){return J}var K=parseInt(J);if(o.isNumber(K)&&K>=0&&K<=16777215){return H(K)}if(/^#[\dA-F]{6}$/i.test(J)){return x(J)}if(/^0x[\dA-F]{6}$/i.test(J)){return E(J)}if(/^rgb/.test(J)){return a(J)}return null};function H(J){return E((new Number(J)).toString(16))}function a(K){var J=K.replace(/[rgb\(\)\s]/g,"").split(",");return o.color(J[0],J[1],J[2])}function x(J){return r(/^#/,J)}function E(J){return r(/^0x/,J)}function r(J,K){var L=K.replace(J,"");return y(L.substr(0,2),L.substr(2,2),L.substr(4,2))}function y(M,L,J){function K(N){return o.isNullOrEmpty(N)?0:o.str.format("0x{0}",N)}return o.color(parseInt(K(M)),parseInt(K(L)),parseInt(K(J)))}function A(J,K){if(!o.isNumber(J)||!o.isNumber(K)){throw o.exception("arg",o.str.format("at $.coord({0},{1})",J,K))}A.base.call(this);this.x(J).y(K)}A.prototype={x:function(J){return this.property("x",J)},y:function(J){return this.property("y",J)},abs:function(){return o.coord(Math.abs(this._x),Math.abs(this._y))},add:function(K){var J=this._x+K.x(),L=this._y+K.y();return o.coord(J,L)},divide:function(K){var J=this._x/K.x(),L=this._y/K.y();return o.coord(J,L)},equals:function(J){return(J instanceof A)&&((this._x===J.x())&&(this._y===J.y()))},multiply:function(K){var J=this._x*K.x(),L=this._y*K.y();return o.coord(J,L)},subtract:function(K){var J=this._x-K.x(),L=this._y-K.y();return o.coord(J,L)},round:function(J){var K=J||0;return o.coord(o.math.round(this.x(),K),o.math.round(this.y(),K))},isAbove:function(J){return this.y()<J.y()},isBelow:function(J){return this.y()>J.y()},isLeftOf:function(J){return this.x()<J.x()},isRightOf:function(J){return this.x()>J.x()},distanceFrom:function(J){return new o.vector(this.x()-J.x(),this.y()-J.y())},distanceTo:function(J){return this.distanceFrom(J).invert()},half:function(){return this.divide(o.coord(2,2))},value:function(){return{x:this._x,y:this._y}},toEm:function(){return v(this,"em")},toPixel:function(){return v(this,"px")},toString:function(){return o.str.format("({0},{1})",this._x,this._y)}};o.ext(A,o.Class);function v(K,J){return{x:function(){return K.x()+J},y:function(){return K.y()+J}}}o.coord=function(J,K){return new A(J,K)};o.coord.Class=A;o.coord.zero=function(){return o.coord(0,0)};o.coord.canParse=function(K){try{if(("left" in K)&&("top" in K)){return !isNaN(K.left)&&!isNaN(K.top)}if(("width" in K)&&("height" in K)){return !isNaN(K.width)&&!isNaN(K.height)}return false}catch(J){return false}};o.coord.random=function(L,K){var J=L*Math.random(),M=K*Math.random(K);return o.coord(J,M)};o.coord.parse=function(J){if(("left" in J)&&("top" in J)){return o.coord(J.left,J.top)}if(("width" in J)&&("height" in J)){return o.coord(J.width,J.height)}return null};o.coord.tryParse=function(J){return o.coord.canParse(J)?o.coord.parse(J):null};function d(O,M,J,P,L,Q,K){if((M<1)||(M>12)){throw new o.exception("arg","Invalid month at $.dayPoint")}if((J<1)||(J>u(M,O))){throw new o.exception("arg","Invalid date at $.dayPoint")}this._value=(arguments.length>=3)?new Date(O,M-1,J,P||0,L||0,Q||0,K||0):new Date();var R=this._value;function S(T){return T<10?"0"+T:""+T}this._day=R.getDay();this._date=J;this._month=M;this._year=O;this._hour=S(R.getHours());this._minute=S(R.getMinutes());this._second=S(R.getSeconds());this._millisecond=S(R.getMilliseconds());var N=this._day;this._isWeekday=N>0&&N<6;this._isWeekend=!this._isWeekday}d.prototype={value:function(){return this._value},day:function(){return this._day},date:function(){return this._date},month:function(){return this._month},year:function(){return this._year},hour:function(){return this._hour},minute:function(){return this._minute},second:function(){return this._second},millisecond:function(){return this._millisecond},isWeekday:function(){return this._isWeekday},isWeekend:function(){return this._isWeekend},equals:function(J){return this._value==J.value()},nextDay:function(){return g(this,1,0,0)},prevDay:function(){return g(this,-1,0,0)},nextMonth:function(){return g(this,0,1,0)},prevMonth:function(){return g(this,0,-1,0)},nextYear:function(){return g(this,0,0,1)},prevYear:function(){return g(this,0,0,-1)},add:function(O,J,T){function S(V,Z,Y){var W=V,X=Z;while(X--){W=W[Y]()}return W}var R=O<0,U=Math.abs,Q=U(O),P=U(T),L=U(J),K=R?"prevYear":"nextYear",N=R?"prevDay":"nextDay",M=R?"prevMonth":"nextMonth";return S(S(S(this,Q,K),L,M),P,N)},firstDayOfMonth:function(){return new d(this._year,this._month,1)},lastDayOfMonth:function(){return new d(this._year,this._month,u(this._month,this._year))},isBefore:function(J){return !(this.isAfter(J)||this.equals(J))},isAfter:function(K){var J=this._year,M=K.year(),L=this._month,N=K.month();if(J>M){return true}if((J==M)&&(L>N)){return true}if((J==M)&&(L==N)&&(this._date>K.date())){return true}return false},equals:function(J){return(this._year==J.year())&&(this._month==J.month())&&(this._date==J.date())},toString:function(){var M=this._year,J=this._month,L=this._date,K=(J<10&&L<10)?"0{1}/0{2}/{0}":(J<10)?"0{1}/{2}/{0}":(L<10)?"{1}/0{2}/{0}":"{1}/{2}/{0}";return o.str.format(K,M,J,L)},toDate:function(){return this.value()}};o.dayPoint=function(N,O,L,J,M,P,K){if(!(o.isDate(N)||(o.isNumber(N)&&o.isNumber(O)&&o.isNumber(L)))){return null}return new d(N,O,L,J,M,P,K)};o.dayPoint.canParse=function(J){return(o.isString(J)||o.isNumber(J)||o.isDate(J))?!isNaN(new Date(J).valueOf()):false};o.dayPoint.parse=function(R){if(R instanceof d){return R}if(!(o.isDate(R)||this.canParse(R))){return null}var J=new Date(R),Q=J.getFullYear(),L=J.getMonth()+1,P=J.getDate(),N=J.getHours(),O=J.getMinutes(),S=J.getSeconds(),K=J.getMilliseconds();return o.dayPoint(Q,L,P,N,O,S,K)};o.dayPoint.tryParse=function(J){return o.dayPoint.canParse(J)?o.dayPoint.parse(J):null};var q;o.dayPoint.assumeNow=function(J){q=o.dayPoint.parse(J)};o.dayPoint.today=function(){return q||o.dayPoint.parse(new Date())};function u(L,K){var J=L,M=K;if(J==2){return(D(M))?29:28}return(((J<8)&&(o.isEven(J)))||((J>7)&&(o.isOdd(J))))?30:31}function D(J){var L=J.toString().split(/\B/),K=parseFloat(o.str.build(L[L.length-2],L[L.length-1]));return(K%4==0)}function g(P,U,L,W){var Y=P.month(),Q=P.year(),N=P.date(),J=u(Y,Q),X=U,O=L,T=W,K=N+X,S=Y+O,V=Q+T;if((N+X)>J){K=1;S=(Y+(O+1))}if((N+X)<1){var M=P.prevMonth(),K=u(M.month(),M.year());(S=Y+(O-1))}if((S)>12){S=1;V=(Q+(T+1))}if((S)<1){S=12;V=(Q+(T-1))}var R=u(S,V);K=(K>R)?R:K;return new d(V,S,K)}function I(K,M,L,J){if(!o.isNumber(K)){throw o.exception("arg",o.str.format("Invalid parameter: code {0}",K))}this._code=K;this.alt(M||false).ctrl(L||false).shift(J||false)}I.prototype={code:function(J){return this.property("code",J)},alt:function(J){return this.property("alt",J)},ctrl:function(J){return this.property("ctrl",J)},shift:function(J){return this.property("shift",J)},equals:function(J){return this._code==J.code()&&this._alt==J.alt()&&this._ctrl==J.ctrl()&&this._shift==J.shift()},toString:function(){return o.str.parse(this._code)}};o.ext(I,o.Class);o.key=function(K,M,L,J){return new I(K,M,L,J)};o.key.canParse=function(J){return o.isNumber(e(J))};o.key.parse=function(J){try{return new I(e(J),J.altKey,J.ctrlKey,J.shiftKey)}catch(J){throw o.exception("arg")}};o.key.tryParse=function(J){return o.key.canParse(J)?o.key.parse(J):null};function e(J){try{return(o.exists(J.which))?J.which:event.keyCode}catch(J){return null}}function w(O,L){if(isNaN(O)){throw new o.exception("arg",o.str.format("$.money requires a number. Passed {0}",O))}var K=O.toString().split(/\./),M=K[0],N=K[1];function J(P){return(O<0)?-P:P}this._cents=(o.exists(N))?J(parseFloat("."+N)):0;this._dollars=parseInt(M);this._type=L||"$";this._value=O}w.prototype={cents:function(){return this._cents},dollars:function(){return this._dollars},type:function(){return this._type},value:function(){return this._value},add:function(J){money_checkType(this,J);return new w(this._value+J.value())},divide:function(J){if(!o.isNumber(J)){throw new Error()}return new w(this._value/J)},equals:function(J){return(this.isOfType(J))&&(this._value==J.value())},isOfType:function(J){return this._type==J.type()},isGreaterThan:function(J){money_checkType(this,J);return this._value>J.value()},isLessThan:function(J){money_checkType(this,J);return this._value<J.value()},multiply:function(J){if(!o.isNumber(J)){throw new Error()}return new w(this._value*J)},round:function(){return new w(o.math.round(this.value,-2))},roundDown:function(){return new w(o.math.roundDown(this.value,-2))},roundUp:function(){return new w(o.math.roundUp(this.value,-2))},subtract:function(J){money_checkType(this,J);return new w(this._value-J.value())},toString:function(){var J=(this.value<0)?"({0}{1}.{2})":"{0}{1}.{2}";return o.str.format(J,this._type,money_formatDollars(this),money_formatCents(this))}};o.money=function(K,J){return new w(K,J)};o.money.zero=function(){return o.money(0)};o.money.isMoney=function(J){return J instanceof w};o.money.canParse=function(J){try{o.money.parse(J);return true}catch(K){return false}};o.money.parse=function(O){if(o.isNumber(O)){return o.money(O)}var J=/(\(.*\))|(\-)/.test(O),N=(J)?1:0,M=O.match(/[^\d\.\,\-]/g)||[],L=o.exists(M[N])?M[N]:"$",P=parseFloat(O.replace(/[^\d\.]/g,"")),K=(J)?-P:P;return o.money(K,L)};o.money.tryParse=function(J){return o.money.canParse(J)?o.money.parse(J):null};money_checkType=function(K,J){if(!K.isOfType(J)){throw new o.exception("operation","Invalid operation on non-conforming currencies.")}};money_formatDollars=function(J){var K=J.dollars(),M=(J.cents()>=0.995)?(K+1):K,R=M.toString(),O=R.replace(/\-/,"").split(/\B/).reverse(),L=O.length,P=L>3,N=0,Q=[];while(N<L){Q[Q.length]=O[N];N++;if(!o.exists(O[N])){break}if((N%3==0)&&P){Q[Q.length]=","}}return o.str.build.apply(this,Q.reverse())};money_formatCents=function(L){var M=o.math.round(L.cents(),-3),K=M.toString(),N=K.replace(/\-|(0\.)/g,"").concat("0").split(/\B/),J=N.length;if(o.isZero(J)||M>=0.995){return"00"}if(J<2){return"0"+N[0]}return(parseInt(N[2])>4)?N[0]+(parseInt(N[1])+1):N[0]+N[1]};function F(K,J){F.base.call(this);this._topLeft=K;this._bottomRight=J}F.prototype={topLeft:function(){return this.get("topLeft")},bottomRight:function(){return this.get("bottomRight")},contains:function(L){var K=this._topLeft,J=this._bottomRight;return K.isAbove(L)&&K.isLeftOf(L)&&J.isRightOf(L)&&J.isBelow(L)}};o.ext(F,o.Class);o.rectangle=function(K,J){return new F(K,J)};function h(J,K){if(!o.isNumber(J)||!o.isNumber(K)){throw o.exception("args",o.str.format("at $.vector({0},{1})",J,K))}h.base.call(this,J,K);this._lengthSquared=G(this,J,K);this._length=k(this,this._lengthSquared);this._unitNormalX=z(this,J);this._unitNormalY=z(this,K)}h.prototype={magnatude:function(){return this.get("length")},equals:function(J){return(J instanceof h)&&((this._x===J.x())&&(this._y===J.y()))},normal:function(){return o.vector(this._unitNormalX,this._unitNormalY)},invert:function(){return o.vector(this.x()*-1,this.y()*-1)},norm:function(){return o.vector(Math.abs(this.x()),Math.abs(this.y()))},perpendicular:function(){return o.vector(this.y()*-1,this.x())},isZero:function(){return this.x()==0&&this.y()==0},add:function(J){return o.vector(this.x()+J.x(),this.y()+J.y())},dot:function(J){return(this.x()*J.x())+(this.y()*J.y())},perpendicularAtTo:function(J){var K=J.add(this.projectionOfOnto(J).invert());return o.vector(K.x(),K.y())},projectionOfOnto:function(J){var K=J.normal().scale(this.dot(J.normal()));return o.vector(K.x(),K.y())},scale:function(J){return o.vector((this.x()*J),(this.y()*J))},unitNormalDot:function(J){return(this.normal().x()*J.normal().x())+(this.normal().y()*J.normal().y())},reflect:function(J){if(J.isZero()){return this}var K=J.normal();return this.add(K.scale(2*(K.dot(this))).invert())},round:function(J){var K=J||0;return o.vector(o.math.round(this.x(),K),o.math.round(this.y(),K))}};o.ext(h,o.coord.Class);function k(J,K){if(J.isZero()){return 0}return Math.sqrt(K)}function G(K,J,L){if(K.isZero()){return 0}return Math.pow(J,2)+Math.pow(L,2)}function z(K,J){if(K.isZero()){return 0}return J/K.magnatude()}o.vector=function(J,K){return new h(J,K)};o.vector.Class=h;o.vector.zero=function(){return o.vector(0,0)};o.vector.random=function(L,K){var J=L*Math.random(),M=K*Math.random();return o.vector(J,M)}})($);(function($){if(!$){$={}}function cookie(){cookie.base.call(this)}cookie.prototype={name:function(name){return this.property("name",name)},expires:function(expires){return this.property("expires",expires)},domain:function(domain){return this.property("domain",domain)},path:function(path){return this.property("path",path)},isSecure:function(isSecure){return this.property("isSecure",isSecure)},erase:function(){this.expires(new Date("1/1/2000"));this.save();return this},save:function(obj){document.cookie=$.cookie.serialize(obj,{name:this._name,expires:this._expires,path:this._path,domain:this._domain,isSecure:this._isSecure});return this}};$.ext(cookie,$.Class);$.cookie=function(params){var p=params||{},o=($.isString(p))?cookie_defaultParams.replicate().merge({name:p}).toObject():cookie_defaultParams.replicate().merge(p).toObject();return(new cookie()).name(o.name).expires(o.expires).path(o.path).domain(o.domain).isSecure(o.isSecure)};$.cookie.erase=function(name){$.cookie.load(name).erase()};$.cookie.load=function(name){var o=($.isObject(name))?name:{name:name};p=cookie_defaultParams.replicate().merge(o).toObject();return $.cookie(p)};$.cookie.find=function(name){var c=document.cookie.split("; "),i=c.length;while(i--){var cke=c[i].split("=");if(cke[0]===name){return c[i]}}return null};$.cookie.serialize=function(obj,params){var pms=params||{},o=cookie_defaultParams.replicate().merge(pms).toObject(),n=o.name,e=o.expires,p=o.path,d=o.domain,s=o.isSecure,I=cookie_buildInfoPair(n,escape($.json.serialize(obj))),E=($.isDate(e))?cookie_buildInfoPair("; expires",e.toGMTString()):"",P=(!p)?"":cookie_buildInfoPair("; path",escape(p)),D=(!d)?"":cookie_buildInfoPair("; domain",escape(d)),S=(!s)?"":"; secure";return I+E+P+D+S};$.cookie.deserialize=function(cookie){try{var ck=(/;/.test(cookie))?cookie.substring(0,cookie.search(";")).split("="):cookie.split("="),kv={key:ck[0],value:ck[1]};return $.json.deserialize(unescape(kv.value))}catch(e){throw $.exception("arg",$.str.format("Cannot deserialize {0}",cookie))}};var cookie_defaultParams=$.hash({name:$.uid("COOKIE"),expires:$.dayPoint.today().nextYear().toDate(),path:"/",domain:null,isSecure:false});var cookie_buildInfoPair=function(k,v){return k+"="+v};function dto(obj){dto.base.call(this,obj)}dto.prototype={name:function(name){return this.set("name",name)},toJson:function(){return $.json.serialize(this.$h)},toQueryString:function(){return $.queryString.serialize(this.$h)},saveAs:function(name){if(!name){throw $.exception("arg","$.dto.saveAs requires a name")}$.cookie(name).save(this.$h);this._name=name;return this},save:function(){var name=this._name||$.uid("dto");this.saveAs(name);return name},erase:function(){var name=this._name;if($.exists(name)){$.cookie.erase(name)}return this},replicate:function(){return $.dto($.replicate(this.$h))}};$.ext(dto,$.hash.Class);$.dto=function(obj){return new dto(obj)};$.dto.parseJson=function(str){return $.dto($.json.deserialize(str))};$.dto.parseQueryString=function(str){return $.dto($.queryString.deserialize(str))};$.dto.serialize=function(name){try{return new dto($.cookie.deserialize($.cookie.find(name))).name(name)}catch(e){return null}};$.json={serialize:function(obj){if($.isNull(obj)){return null}if($.isUndefined(obj)){return undefined}if(!$.isArray(obj)&&!$.isObject(obj)){return obj.toString()}var r=[],f=($.isArray(obj))?"[{0}]":"{{0}}";for(var n in obj){var o=obj[n];if($.isFunction(o)){continue}var v=($.isNumber(o))?o:($.isString(o))?'"'+o+'"':$.json.serialize(o);r[r.length]=(($.isObject(obj)&&!$.isArray(obj))?('"'+n+'":'):"")+v}return $.str.format(f,r)},deserialize:function(str){if($.isObject(str)){return str}if($.isString(str)){try{return eval("("+str+")")}catch(e){return str}}return undefined}};$.queryString={serialize:function(obj){var r="",e=encodeURIComponent;for(var n in obj){r+=$.str.format("&{0}={1}",e(n),e($.json.serialize(obj[n])))}return r.replace(/^\&/,"")},deserialize:function(str){var q=str.replace(/.*\?/,""),o={},kvs=q.split("&");if(!/\??\w+=\w+/.test(str)){return null}for(var n in kvs){var d=decodeURIComponent,kv=(kvs[n]).split("=");o[d(kv[0])]=$.json.deserialize(d(kv[1]))}return o}}})($);(function(k){if(!k){k={}}var h=k.hash({1:"MOUSE_LEFT",2:"",3:"MOUSE_RIGHT",4:"",5:"",6:"",7:"",8:"BACKSPACE",9:"TAB",10:"",11:"",12:"",13:"ENTER",14:"",15:"",16:"SHIFT",17:"CTRL",18:"ALT",19:"",20:"CAPS",21:"",22:"",23:"",24:"",25:"",26:"",27:"ESC",28:"",29:"",30:"",31:"",32:"SPACE",33:"PAGEUP",34:"PAGEDOWN",35:"END",36:"HOME",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN",41:")",42:"*",43:"+",44:",",45:"-",46:".",47:"/",48:"0",49:"1",50:"2",51:"3",52:"4",53:"5",54:"6",55:"7",56:"8",57:"9",58:":",59:";",60:"<",61:"=",62:">",63:"?",64:"@",65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",91:"[",92:"\\",93:"]",94:"^",95:"_",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"=",108:"l",109:"-",110:"n",111:"o",112:"p",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",124:"|",125:"}",126:"~",127:"",128:"",129:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",141:"",142:"",143:"",144:"",145:"",146:"",147:"",148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",157:"",158:"",159:"",160:"",161:"",162:"",163:"",164:"",165:"",166:"",167:"",168:"",169:"",170:"",171:"",172:"",173:"",174:"",175:"",176:"",177:"",178:"",179:"",180:"",181:"",182:"",183:"",184:"",185:"",186:"",187:"",188:",",189:"",190:".",191:"/",192:"`",193:"",194:"",195:"",196:"",197:"",198:"",199:"",200:"",201:"",202:"",203:"",204:"",205:"",206:"",207:"",208:"",209:"",210:"",211:"",212:"",213:"",214:"",215:"",216:"",217:"",218:"",219:"[",220:"\\",221:"]",222:"",223:"",224:"",225:"",226:"",227:"",228:"",229:"",230:"",231:"",232:"",233:"",234:"",235:"",236:"",237:"",238:"",239:"",240:"",241:"",242:"",243:"",244:"",245:"",246:"",247:"",248:"",249:"",250:"",251:"",252:"",253:"",254:"",255:""});function a(){this._hotKeys=k.hash();this._map=k.hash(h)}a.prototype={map:function(r){return this.set("map",r);s},findCode:function(v){var r=this._map.findKey(v),u=parseInt(r);return isNaN(u)?null:u},findKey:function(r){return this._map.findValue(r)}};k.ext(a,k.Class);var q=new a();k.keyboard=function(){return q};function d(){}d.prototype={from:function(r){return(k.exists(r.relatedTarget))?r.relatedTarget:r.fromElement},target:function(r){return(r.srcElement)?r.srcElement:r.target},clientCoord:function(r){if(!k.exists(r.clientX)){return null}return new k.coord(r.clientX,r.clientY)},documentCoord:function(r){if(k.exists(this.pageCoord(r))){return this.pageCoord(r)}var u=document.documentElement;return new k.coord(r.clientX+u.scrollLeft,r.clientY+u.scrollTop)},pageCoord:function(r){if(!k.exists(r.pageX)){return null}return new k.coord(r.pageX,r.pageY)},screenCoord:function(r){return new k.coord(r.screenX,r.screenY)},selection:function(){if(k.exists(window.getSelection)){return window.getSelection()}if(k.exists(document.getSelection)){return document.getSelection()}if(k.exists(document.selection)&&k.exists(document.selection.createRange)){return document.selection.createRange().text}if(k.exists(document.activeElement)&&k.exists(document.activeElement.selectionStart)){var u=document.activeElement.selectionStart,r=document.activeElement.selectionEnd;return document.activeElement.value.substring(u,r)}return null},clearSelection:function(){var r=this.selection();try{r.removeAllRanges()}catch(u){r.empty()}return this}};k.ext(d,k.Class);var g=new d();k.mouse=function(){return g};function o(){}o.prototype={canRead:function(r){return k.exists(r.touches)},from:function(u){var r=u.touches[0];return(k.exists(r.relatedTarget))?r.relatedTarget:r.fromElement},target:function(u){var r=u.touches[0];return(r.srcElement)?r.srcElement:r.target},clientCoord:function(u){var r=u.touches[0];if(!k.exists(r.clientX)){return null}return new k.coord(r.clientX,r.clientY)},documentCoord:function(u){var r=u.touches[0];if(k.exists(this.pageCoord(u))){return this.pageCoord(u)}var v=document.documentElement;return new k.coord(r.clientX+v.scrollLeft,r.clientY+v.scrollTop)},pageCoord:function(u){var r=u.touches[0];if(!k.exists(r.pageX)){return null}return new k.coord(r.pageX,r.pageY)},screenCoord:function(u){var r=u.touches[0];return new k.coord(r.screenX,r.screenY)},selection:function(){if(k.exists(window.getSelection)){return window.getSelection()}if(k.exists(document.getSelection)){return document.getSelection()}if(k.exists(document.selection)&&k.exists(document.selection.createRange)){return document.selection.createRange().text}if(k.exists(document.activeElement)&&k.exists(document.activeElement.selectionStart)){var u=document.activeElement.selectionStart,r=document.activeElement.selectionEnd;return document.activeElement.value.substring(u,r)}return null},clearSelection:function(){var r=this.selection();try{r.removeAllRanges()}catch(u){r.empty()}return this}};k.ext(o,k.Class);var e=new o();k.touch=function(){return e}})($);(function(q){if(!q){q={}}q.DomClass=function(Q){q.DomClass.base.call(this);this.dom(q.refcheck(Q,q.str.format("$.DomClass requires valid DOM node.")))};q.DomClass.prototype={dom:function(Q){return this.property("dom",Q)}};q.ext(q.DomClass,q.Class);var d=function(){};d.prototype={};q.ext(d,q.Class);function P(){P.base.call(this);this._processId=q.uid("svc");this._onSuccess=q.observer();this._onError=q.observer();this._onComplete=q.observer();this._lock=q.lock();this._isLocal=false;this.GET().text().xhr().async().unlock()}P.prototype={processId:function(){return this.get("processId")},verb:function(Q){return this.property("verb",Q)},callType:function(Q){return this.property("callType",Q)},responseType:function(Q){return this.property("responseType",Q)},uri:function(Q){return this.property("uri",Q)},maxAttempts:function(Q){return this.property("maxAttempts",Q)},isLocal:function(Q){return this.property("isLocal",Q)},strategy:function(Q){if(q.exists(Q)){Q.context(this)}return this.property("strategy",Q)},isAsync:function(){return/ASYNC/i.test(this.callType())},isPost:function(){return/POST/i.test(this.verb())},isLocked:function(){return this._lock.isLocked()},isBusy:function(){return this._isBusy},onSuccess:function(R,Q,S){this._onSuccess.add(R,Q,S);return this},onError:function(R,Q,S){this._onError.add(R,Q,S);return this},onComplete:function(R,Q,S){this._onComplete.add(R,Q,S);return this},removeListener:function(Q){this._onSuccess.add(Q);this._onError.add(Q);this._onComplete.add(Q);return this},clearListeners:function(){this._onSuccess.clear();this._onError.clear();this._onComplete.clear();return this},OPTIONS:function(){return this.verb("OPTIONS")},GET:function(){return this.verb("GET")},HEAD:function(){return this.verb("HEAD")},POST:function(){return this.verb("POST")},PUT:function(){return this.verb("PUT")},DELETE:function(){return this.verb("DELETE")},TRACE:function(){return this.verb("TRACE")},CONNECT:function(){return this.verb("CONNECT")},xhr:function(){return this.strategy(new u())},xss:function(){return this.strategy(new h())},sync:function(){return this.callType("sync")},async:function(){return this.callType("async")},text:function(){return this.responseType("responseText")},xml:function(){return this.responseType("responseXML")},success:function(Q){this._onSuccess.notify(Q,this._processId);return this},error:function(Q){this._onError.notify(Q,this._processId);return this},complete:function(Q){this._onComplete.notify(Q,this._processId);this._isBusy=false;return this},lock:function(){this._lock.lock();return this},unlock:function(){this._lock.unlock();return this},abort:function(){if(!this._isBusy){return this}this.strategy().abort();return this},call:function(Q){if(this.isLocked()){return this}this._isBusy=true;this.strategy().call(Q);return this}};q.ext(P,q.Class);q.service=function(){return new P()};q.service.noCache=function(R){var Q=q.dto({noCache:q.uid()});if(!q.exists(R)){return Q}return R.merge(Q)};function u(){u.base.call(this);this._isOk=function(Q){return/[23]\d{2}/.test(Q)||this.context().isLocal()};this._isAborted=function(Q){return !/\d{3}/.test(Q)};this._attempts=0}u.prototype={context:function(Q){return this.property("context",Q)},abort:function(){try{this._xhr.abort()}catch(Q){}},call:function(U){this._xhr=x();var R=this.context(),S=R.isPost(),T=this._xhr,Q=q.exists(U);format=(S||!Q)?"{0}":"{0}?{1}",postParams=(S)?U:null,paramLength=(Q)?U.length:0;me=this;if(!q.exists(T)){R.error(new Error("Ajax not supported"))}T.open(R.verb(),q.str.format(format,R.uri(),U),R.isAsync());if(S){T.setRequestHeader("Content-type","application/x-www-form-urlencoded");T.setRequestHeader("Content-length",paramLength);T.setRequestHeader("Connection","close")}T.onreadystatechange=function(){if(T.readyState>3){var W=T[R.responseType()],V=T.status;if(me._isAborted(V)){return}if(me._isOk(V)){R.success(W).complete(W);return}if(me._attempts<R.maxAttempts()){me.call(U);return}R.error(W).complete(W)}};T.send(postParams)}};q.ext(u,q.Class);function x(){return(q.exists(XMLHttpRequest))?new XMLHttpRequest():(q.exists(window.ActiveXObject))?(function(){var Q=["MSXML2.Http6.0","MSXML2.Http5.0","MSXML2.Http4.0","MSXML2.Http3.0","MSXML2.Http"];for(var S in Q){try{return new ActiveXObject(Q[S])}catch(R){}}return null})():null}function h(){u.base.call(this);this._head=document.documentElement.getElementsByTagName("head")[0]}h.prototype={context:function(Q){return this.property("context",Q)},abort:function(){try{this._head.removeChild(this._script)}catch(Q){}},call:function(T){var Q=this.context(),V=document.documentElement.getElementsByTagName("head")[0],X="{0}?ku4jXssOnSuccess=kodmunki.{1}&ku4jXssOnError=kodmunki.{2}&ku4jXssOnComplete=kodmunki.{3}{4}",S=Q.processId(),Z=S+"_success",U=S+"_error",R=S+"_complete",Y=(q.exists(T))?"&"+T:"",W=q.str.format(X,Q.uri(),Z,U,R,Y);this._script=q.create({script:{src:W,language:"javascript",type:"text/javascript"}});kodmunki[Z]=function(){Q.success.apply(Q,arguments)};kodmunki[U]=function(){Q.error.apply(Q,arguments)};kodmunki[R]=function(){Q.complete.apply(Q,arguments)};this._head.appendChild(this._script)}};q.ext(h,q.Class);var K={css:{addClass:function(S,Q){var R=q.ele(S),T=R.className;if(q.ku.css.hasClass(S,Q)){return}R.className+=(/^[^\s]/.test(T))?(" "+Q):Q},hasClass:function(R,Q){if(!q.exists(Q)){return false}return(new RegExp(Q)).test((q.ele(R)).className)},removeClass:function(S,Q){var R=q.ele(S),T=R.className;if(!q.ku.css.hasClass(S,Q)){return}R.className=q.str.trim(T.replace(new RegExp("(^|\\s)"+Q+"(?![\\w\\-])"),""))}},getText:function(R){var Q=q.ele(R);return Q.textContent||Q.innerText},quirks:{setOpacity:function(S,R){var Q=R/100;S.style.opacity=Q;S.style["-moz-opacity"]=Q;S.style["-webkit-opacity"]=Q;S.style.filter=q.str.format("alpha(opacity={0})",R)},clearOpacity:function(Q){q.ku.style.set(Q,{opacity:null,"-moz-opacity":null,"-webkit-opacity":null,filter:null})}},ready:function(R,Q){a[a.length]={f:R,b:Q||false}},redraw:function(T){var S=q.ele(T)||document.documentElement,R=S.style.display||"";S.style.display="none";var Q=S.offsetHeight;S.style.display=R},style:{set:function(W,S,T){var V=q.ele(W);function Q(Y){return(/\-/.test(Y))?Y.replace(/\-\w/,Y.charAt(Y.indexOf("-")+1).toUpperCase()):Y}if(q.isString(S)){try{V.style[Q(S)]=T}catch(U){}}for(var X in S){var R=Q(X);if(/opacity/i.test(R)){q.ku.quirks.setOpacity(W,S[X]);continue}try{V.style[R]=S[X]}catch(U){continue}}},get:function(W,T){var V=q.ele(W);function Q(aa,Y){var X=(/\-/.test(Y))?Y.replace(/\-\w/,Y.charAt(Y.indexOf("-")+1).toUpperCase()):Y;try{return window.getComputedStyle(aa,null).getPropertyValue(Y)}catch(Z){return(q.exists(aa.currentStyle))?aa.currentStyle[Y]:(q.exists(aa.style))?aa.style[X]:""}}if(/opacity/i.test(T)){var R=Q(V,T);if(q.exists(R)){return parseFloat(R)*100}else{var S=/alpha\(opacity=\d+(\.\d+)?\)/i.exec(V.style.filter);if(!q.exists(S)){return 100}var U=/\d+(\.\d+)?/i.exec(S[0]);if(!q.exists(U)){return 100}return parseFloat(U[0])}}return Q(V,T)},toNumber:function(Q){return parseFloat(this.stripUnit(Q))},stripUnit:function(Q){return(q.exists(Q)&&q.exists(Q.replace))?Q.replace(/[^\-\.\d]/g,""):Q},getUnit:function(Q){return Q.match(/[^\-\.\d]{2}/)[0]}},swapDom:function(S,R){var Q=q.ele(S);f=q.ele(R);Q.parentNode.replaceChild(f,Q)}};q.ku=K;q.clearNode=function(R){var Q=q.ele(R);if(!Q){return}while(Q.hasChildNodes()){Q.removeChild(Q.firstChild)}};q.create=function(X){if(!X){return null}var R=(q.isString(X))?{x:{}}:X,Z,V;for(var S in R){if(S=="content"){continue}Z=document.createElement(S);attrs=R[S]}for(var S in attrs){var Y=attrs[S];if(/class/i.test(S)){q.ku.css.addClass(Z,Y);continue}if(/style/i.test(S)){q.ku.style.set(Z,Y);continue}Z.setAttribute(S,Y)}try{var W=R.content;if(!W){return Z}var T=(!W)?1:W.length;if(q.exists(W.nodeName)){Z.appendChild(W);return Z}if(!q.isArray(W)){Z.innerHTML+=W;return Z}while(T--){var Q=W[T];if(q.isString(Q)||!isNaN(Q)){Z.innerHTML+=Q;continue}var R=(Q.hasOwnProperty("appendChild"))?Q:q.create(Q);Z.appendChild(R)}}catch(U){}finally{return Z}};q.ele=function(Q){if(!Q){return null}return(q.isEvent(Q))?q.evt.ele(Q):(q.isString(Q))?document.getElementById(Q):(q.exists(Q.dom))?Q.dom:Q};var D=function(U,R,T,S,Q){this.dom=U;this.evt=R;this.action=T;this.scope=S;this.bubbles=Q};q.evt={add:function(R,X,Q,Y,S){var U=q.refcheck(q.ele(R),q.str.format("argument dom == {0} at $.evt.add",R)),T=X,Z=Y||U,V=S||false,W=function(){Q.apply(Z,arguments)};if(q.exists(U.addEventListener)){U.addEventListener(T,W,V)}else{if(q.exists(U.attachEvent)){U.attachEvent("on"+T,W)}else{U["on"+T]=W}}return new D(U,T,W,Z,V)},remove:function(T){var V=T.dom,U=T.evt,S=T.scope,Q=T.bubbles,R=T.action;if(V.removeEventListener){V.removeEventListener(U,R,Q)}else{if(V.detachEvent){V.detachEvent("on"+U,R)}else{V["on"+U]=null}}return this},ele:function(Q){try{return(Q.srcElement)?Q.srcElement:Q.target}catch(Q){return null}},mute:function(Q){if(q.exists(Q.preventDefault)){Q.preventDefault()}if(q.exists(Q.stopPropogation)){Q.stopPropogation()}Q.returnValue=false;Q.cancelBubble=true;return this}};q.findOuterDims=function(R){var Q=q.ele(R);return{width:Q.offsetWidth,height:Q.offsetHeight}},q.findInnerDims=function(R){var Q=q.ele(R);return{width:Q.clientWidth,height:Q.clientHeight}},q.findOffset=function(S){var R=q.ele(S),Q=0,T=0;if(!R){return null}do{Q+=R.offsetLeft;T+=R.offsetTop}while((function(){try{R=R.offsetParent}catch(U){R=null}return q.exists(R)})());return{left:Q,top:T}};q.findBoundedOffset=function(R){var Q=q.ele(R);if(!Q){return null}return{left:Q.offsetLeft,top:Q.offsetTop}},q.findScrollDims=function(R){var Q=q.ele(R);return{width:Q.scrollWidth,height:Q.scrollHeight}};q.findScrollOffset=function(S){var R=q.ele(S),Q=0,T=0;if(!R){return null}do{Q+=R.scrollLeft||0;T+=R.scrollTop||0}while((function(){try{R=R.parentNode}catch(U){R=null}return q.exists(R)})());return{left:Q,top:T}};var O=function(R){this._navigator=R;agents={_isIE:"MSIE",_isNetscape:"Netscape",_isFirefox:"Firefox",_isOpera:"Opera",_isSafari:"Safari",_isChrome:"Chrome"};this._isIE=false;this._isNetscape=false;this._isFirefox=false;this._isOpera=false;this._isSafari=false;this._isChrome=false;this._isUnknown=true;this._version="";if(!q.isObject(R)){return}var R=this._navigator,T=R.userAgent;function V(X){return !q.isNullOrEmpty(T)&&(new RegExp(X,"i")).test(T)}function S(ab){try{var Y=(new RegExp("Version\\/(\\d+\\.?){1,}","i")).exec(T),Z=(new RegExp(ab+"\\/(\\d+\\.?){1,}","i")).exec(T),X=q.exists(Y)?Y:Z;return(new RegExp("(\\d+\\.?){1,}")).exec(X[0])[0]}catch(aa){return""}}var W,Q,U;for(W in agents){U=agents[W];Q=V(U);if(!Q){continue}this[W]=Q;this._version=S(U);this._isUnknown=false}this._fullVersion=R.appVersion;this._platform=R.platform;this._allInfo=this._fullVersion+this._platform};O.prototype={isIE:function(){return this._isIE},isNetscape:function(){return this._isNetscape},isFirefox:function(){return this._isFirefox},isOpera:function(){return this._isOpera},isSafari:function(){return this._isSafari&&!this._isChrome},isChrome:function(){return this._isChrome},isUnknown:function(){return this._isUnknown},platform:function(){return this._platform},fullVersion:function(){return this._fullVersion},version:function(){return this._version}};var H;q.ku.browser=function(){if(q.exists(H)){return H}H=new O(navigator);return H};q.ku.browser.Class=O;var G=function(Q){G.base.call(this,q.ele(Q));var R=this.style("display")||"block";this._display=(/none/i.test(R))?"block":R;this._liveEvents=q.hash()};G.prototype={attribute:function(Q,R){var S=this.dom();if(q.isUndefined(R)){return S.getAttribute(Q)}S.setAttribute(Q,R);return this},addClass:function(Q){q.ku.css.addClass(this.dom(),Q);return this},removeClass:function(Q){q.ku.css.removeClass(this.dom(),Q);return this},hasClass:function(Q){q.ku.css.hasClass(this.dom(),Q);return this},style:function(R,Q){if(q.isString(R)&&!q.exists(Q)){return q.ku.style.get(this.dom(),R)}q.ku.style.set(this.dom(),R,Q);return this},value:function(Q){if(!q.exists(Q)){return this.dom().value}this.dom().value=Q;return this},content:function(Q){if(!q.exists(Q)){return this}if(q.isNumber(Q)||q.isString(Q)){return this.html(Q)}return this.appendChild(Q)},cloneNode:function(Q){return this._dom.cloneNode(Q||true)},html:function(Q){if(!q.exists(Q)){return this.dom().innerHTML}this.dom().innerHTML=Q;return this},text:function(Q){if(!q.exists(Q)){return q.ku.getText(this.dom())}q.ku.setText(this.dom(),Q);return this},prependChild:function(R){var S=this.dom(),Q=S.firstChild;if(q.exists(Q)){S.insertBefore(R,Q)}else{S.appendChild(R)}return this},appendChild:function(Q){this.dom().appendChild(Q);return this},removeChild:function(Q){this.dom().removeChild(Q);return this},insertBefore:function(Q){Q.parentNode.insertBefore(this.dom(),Q);return this},insertAfter:function(Q){if(q.exists(Q.nextSibling)){Q.parentNode.insertBefore(this.dom(),Q.nextSibling)}else{Q.parentNode.appendChild(this.dom())}return this},appendTo:function(Q){Q.appendChild(this.dom());return this},detach:function(){try{var R=this.dom();R.parentNode.removeChild(R)}catch(Q){}finally{return this}},innerDims:function(Q){if(!q.exists(Q)){return q.coord.parse(q.findInnerDims(this.dom()))}var R=Q.toPixel();this.style({width:R.x(),height:R.y()});return this},outerDims:function(R){if(!q.exists(R)){return q.coord.parse(q.findOuterDims(this.dom()))}var Q=this.outerDims().subtract(this.innerDims());return this.innerDims(R.subtract(Q))},innerWidth:function(Q){var R=this.innerDims();if(!q.exists(Q)){return q.coord(R.x(),0)}return this.innerDims(q.coord(Q,R.y()))},innerHeight:function(Q){var R=this.innerDims();if(!q.exists(Q)){return q.coord(0,R.y())}return this.innerDims(q.coord(R.x(),Q))},outerWidth:function(Q){var R=this.outerDims();if(!q.exists(Q)){return q.coord(R.x(),0)}return this.outerDims(q.coord(Q,R.y()))},outerHeight:function(Q){var R=this.outerDims();if(!q.exists(Q)){return q.coord(0,R.y())}return this.outerDims(q.coord(R.x(),Q))},boundedOffset:function(){return q.coord.parse(q.findBoundedOffset(this.dom()))},layoutDims:function(){var Q=this.dom().parentNode;if(!q.exists(Q)){return q.coord.zero()}var R=q.dom(Q);return R.outerDims().subtract(R.innerDims()).half()},offset:function(){return q.coord.parse(q.findOffset(this.dom()))},center:function(){return this.offset().add(this.outerDims().half())},scrollDims:function(){return q.coord.parse(q.findScrollDims(this.dom()))},scrollOffset:function(){return q.coord.parse(q.findScrollOffset(this.dom()))},clear:function(){q.clearNode(this.dom());return this},redraw:function(){q.ku.redraw(this.dom());return this},swap:function(Q){q.ku.swapDom(this.dom,Q.dom);return Q},show:function(){this.style({display:this._display});return this},hide:function(){this.style({display:"none"});return this},isVisible:function(){var Q=this.offset(),R=this.offset().add(this.innerDims());return q.exists(this.dom().parentNode)&&!/NONE|^$/i.test(this.style("display"))&&q.window().scrollOffset().isLeftOf(R)&&q.window().scrollOffset().isAbove(R)&&q.window().scrollDims().isRightOf(Q)&&q.window().scrollDims().isBelow(Q)},onmouseover:function(Q,S,R){return this._addEvent("mouseover",Q,S,R)},onmouseout:function(Q,S,R){return this._addEvent("mouseout",Q,S,R)},onmousedown:function(Q,S,R){return this._addEvent("mousedown",Q,S,R)},onmouseup:function(Q,S,R){return this._addEvent("mouseup",Q,S,R)},onmousemove:function(Q,S,R){return this._addEvent("mousemove",Q,S,R)},onclick:function(Q,S,R){return this._addEvent("click",Q,S,R)},ondoubleclick:function(Q,S,R){return this._addEvent("dblclick",Q,S,R)},onkeydown:function(Q,S,R){return this._addEvent("keydown",Q,S,R)},onkeyup:function(Q,S,R){return this._addEvent("keyup",Q,S,R)},onkeypress:function(Q,S,R){return this._addEvent("keypress",Q,S,R)},onblur:function(Q,S,R){return this._addEvent("blur",Q,S,R)},onchange:function(Q,S,R){return this._addEvent("change",Q,S,R)},onerror:function(Q,S,R){return this._addEvent("error",Q,S,R)},onfocus:function(Q,S,R){return this._addEvent("focus",Q,S,R)},onload:function(Q,S,R){return this._addEvent("load",Q,S,R)},onresize:function(Q,S,R){return this._addEvent("resize",Q,S,R)},onscroll:function(Q,S,R){return this._addEvent("scroll",Q,S,R)},onselect:function(Q,S,R){return this._addEvent("select",Q,S,R)},onresize:function(Q,S,R){return this._addEvent("resize",Q,S,R)},onunload:function(Q,S,R){return this._addEvent("unload",Q,S,R)},onorientationchange:function(Q,S,R){return this._addEvent("orientationchange",Q,S,R)},ontouchstart:function(Q,S,R){return this._addEvent("touchstart",Q,S,R)},ontouchend:function(Q,S,R){return this._addEvent("touchend",Q,S,R)},ontouchmove:function(Q,S,R){return this._addEvent("touchmove",Q,S,R)},removeEvent:function(R){var Q=this._liveEvents.find(R);if(!q.exists(Q)){return this}return this._removeEvent(Q,R)},clearEvents:function(){this._liveEvents.listValues().each(function(Q){this._removeEvent(Q)},this);return this},_addEvent:function(S,R,V,U){var Q=U||q.uid("evt"),T=this._liveEvents;if(T.containsKey(Q)){return this}T.add(Q,q.evt.add(this.dom(),S,R,V));return this},_removeEvent:function(Q,R){q.evt.remove(Q);this._liveEvents.remove(R);return this}};q.ext(G,q.DomClass);q.dom=function(Q){return new G(Q)};q.dom.Class=G;function o(){o.base.call(this);this._body=q.dom(document.body)}o.prototype={isDisabled:function(){return this.get("disabled")},isPortrait:function(){return this.orientation.isLandscape()},isLandscape:function(){return Math.abs(window.orientation)==90},disable:function(){this._disabled=true;document.body.appendChild(w);return this},enable:function(){if(!this.isDisabled()){return this}document.body.removeChild(w);this._disabled=false;return this},dims:function(){var Q=window.innerWidth||document.documentElement.clientWidth,R=window.innerHeight||document.documentElement.clientHeight;return q.coord(Q,R)},center:function(){return this.dims().divide(q.coord(2,2))},scrollOffset:function(){var T=document.documentElement,R=document.body,Q=Math.max(T.scrollLeft,R.scrollLeft),S=Math.max(T.scrollTop,R.scrollTop);return q.coord(Q,S)},scrollDims:function(){var T=document.documentElement,R=document.body,Q=Math.max(T.scrollWidth,R.scrollWidth),S=Math.max(T.scrollHeight,R.scrollHeight);return q.coord(Q,S)},scrollCenter:function(){return this.center().add(this.scrollOffset())},contains:function(S){var R=this.scrollOffset(),Q=this.scrollDims();return !(S.isAbove(R)||S.isLeftOf(R)||S.isRightOf(Q)||S.isBelow(Q))},redraw:function(){q.ku.redraw(document.body);q.ku.redraw(document.documentElement);return this},onmousedown:function(Q,S,R){return this._body.onmousedown(Q,S,R)},onmouseup:function(Q,S,R){return this._body.onmouseup(Q,S,R)},ontouchstart:function(Q,S,R){return this._body.ontouchstart(Q,S,R)},ontouchend:function(Q,S,R){return this._body.ontouchend(Q,S,R)},onclick:function(Q,S,R){return this._body.onclick(Q,S,R)},ondoubleclick:function(Q,S,R){return this._body.ondoubleclick(Q,S,R)},onkeydown:function(Q,S,R){return this._body.onkeydown(Q,S,R)},onkeyup:function(Q,S,R){return this._body.onkeyup(Q,S,R)},scrollTo:function(Q){window.scrollTo(Q.x,Q.y);return this},onresize:function(Q,S,R){F.add(Q,S,R);return this},onscroll:function(Q,S,R){M.add(Q,S,R);return this},onspin:function(Q,S,R){J.add(Q,S,R);return this},remove:function(Q){F.remove(Q);M.remove(Q);J.remove(Q);this._body.removeEvent(Q);return this}};q.ext(o,q.Class);var r=q.coord.zero(),N,w=q.create({div:{"class":"ku-window-disabled"}}),F=q.observer(),M=q.observer(),J=q.observer();var A=function(){};A.prototype={uri:function(Q){return this.property("uri",Q)},offset:function(Q){return this.property("offset",Q)},dims:function(Q){return this.property("dims",Q)},channelmode:function(Q){return this.property("channelmode",Q)},directories:function(Q){return this.property("directories",Q)},fullscreen:function(Q){return this.property("fullscreen",Q)},location:function(Q){return this.property("location",Q)},menubar:function(Q){return this.property("menubar",Q)},scrollbars:function(Q){return this.property("scrollbars",Q)},titlebar:function(Q){return this.property("titlebar",Q)},toolbar:function(Q){return this.property("toolbar",Q)},open:function(){}};q.ext(A,q.Class);var L;q.window=function(){if(q.exists(L)){return L}q.evt.add(window,"resize",function(){F.notify()});q.evt.add(window,"scroll",function(){M.notify()});q.evt.add(window,"orientationchange",function(){J.notify()});L=new o();return L};function y(){y.base.call(this);this._onIsValid=q.observer();this._onInvalid=q.observer();this.spec(q.spec(function(){return true})).optional()}y.prototype={$read:function(){return},$write:function(){return},$clear:function(){return},value:function(Q){if(!q.exists(Q)){return this.$read()}this.$write(Q);return this},clear:function(){return this.$clear()},optional:function(){this._optionSpec=q.fields.specs.optional;this._operand="or";return this},required:function(){this._optionSpec=q.fields.specs.required;this._operand="and";return this},spec:function(Q){return this.property("spec",Q)},isValid:function(){var Q=this._optionSpec[this._operand](this.spec()).isSatisfiedBy(this.value()),R=(Q)?this._onIsValid:this._onInvalid;R.notify(this);return Q},isEmpty:function(){return q.isEmpty(this.value())},onIsValid:function(R,Q,S){this._onIsValid.add(R,Q,S);return this},onInvalid:function(R,Q,S){this._onInvalid.add(R,Q,S);return this}};q.ext(y,q.Class);function g(R){g.base.call(this);var Q=q.ele(R);this.dom(q.refcheck(Q,q.str.format("$.DomClass requires valid DOM node."))).spec(q.spec(function(){return true})).optional()}g.prototype={$read:function(){return this.dom().value},$write:function(Q){this.dom().value=Q},$clear:function(){this.dom().value="";return this},dom:function(Q){return this.property("dom",Q)}};q.ext(g,y);q.field=function(Q){return new g(Q)};q.field.Class=g;function z(Q){z.base.call(this,Q)}z.prototype={$read:function(){var Q=this.dom();return(Q.checked)?Q.value:""},$write:function(Q){var R=this.dom();R.checked=(R.value==Q)},$clear:function(){this.uncheck();return this},check:function(){this.dom().checked=true;return this},uncheck:function(){this.dom().checked=false;return this}};q.ext(z,g);q.checkbox=function(Q){return new z(Q)};q.checkbox.Class=z;function E(){E.base.call(this);this._radios=q.list()}E.prototype={$read:function(){var Q=[];this._radios.each(function(R){if(R.checked){Q.push(R.value)}});return Q.toString()},$write:function(S){var R=(q.isString(S))?S.split(","):S,Q=q.list(R);this._radios.each(function(T){T.checked=Q.contains(T.value)})},$clear:function(){this._radios.each(function(Q){Q.checked=false})},add:function(Q){this._radios.add(Q);return this},listNodes:function(){return this._radios}};q.ext(E,y);q.radioset=function(){return new E()};q.radioset.Class=E;function B(Q){B.base.call(this,Q);this._opts=function(){return q.list(this.dom().options)};if(this.dom().multiple){this.multiple()}else{this.single()}}B.prototype={$read:function(){var Q=[];this._opts().each(function(R){if(R.selected){Q.push(R.value)}});return Q.toString()},$write:function(Q){return(this._multiple)?v(this,Q):I(this,Q)},multiple:function(){this._multiple=true;return this},single:function(){this._multiple=false;return this},addOptgroup:function(){this.dom().appendChild(document.createElement("optgroup"));return this},addOption:function(R,Y,U,W){var S=this.dom(),T=document.createElement("option"),X=U||null,Q=(q.exists(X))?S.options[X]:null;T.text=R;T.value=Y;if(W){S.getElementsByTagName("optgroup")[U].appendChild(T)}else{try{S.add(T,Q)}catch(V){S.add(T,X)}}return this},removeOption:function(Q){this.dom().remove(Q);return this}};q.ext(B,g);q.select=function(Q){return new B(Q)};q.select.Class=B;function I(Q,R){Q._opts().each(function(S){S.selected=(S.value==R)});return Q}function v(R,T){var S=(q.isString(T))?T.split(","):T,Q=q.list(S);R._opts().each(function(U){U.selected=Q.contains(U.value)});return R}function e(){e.base.call(this);this._onSubmit=q.observer();this._fields=q.hash()}e.prototype={$submit:function(){return},name:function(Q){return this.property("name",Q)},fields:function(){return this._fields},listFields:function(){return this._fields.listValues()},findField:function(Q){return this._fields.findValue(Q)},isEmpty:function(){var Q=true;this._fields.listValues().each(function(R){if(!R.isEmpty()){Q=false}});return Q},isValid:function(){var Q=true;this._fields.listValues().each(function(R){if(!R.isValid()){Q=false}});return Q},submit:function(){var Q=this.read();this._onSubmit.notify(this);this.$submit(Q)},onSubmit:function(R,Q,S){this._onSubmit.add(R,Q,S);return this},add:function(R,Q){this._fields.add(R,Q);return this},remove:function(Q){this._fields.remove(Q);return this},clear:function(){this._fields.each(function(Q){Q.value.clear()});return this},read:function(){var Q=q.dto();this._fields.each(function(T){var S=T.key,R=T.value;if(q.exists(R.read)){Q.merge(R.read())}if(q.exists(R.value)){Q.add(S,R.value())}});return Q},write:function(Q){if(!q.exists(Q)){return this}this._fields.each(function(S){var R=S.value;if(q.exists(R.write)){R.write(Q)}if(q.exists(R.value)){R.value(Q.find(S.key))}});return this},saveAs:function(Q){this.read().saveAs(Q);this._name=Q;return this},save:function(){var Q=this._name||q.uid("form");this.saveAs(Q);return Q},erase:function(){var Q=this._name;if(q.exists(Q)){q.dto.serialize(Q).erase()}return this},load:function(Q){if(q.isString(Q)){this._name=Q}var R=this._name;return(q.exists(R))?this.write(q.dto.serialize(R)):this}};q.ext(e,q.Class);q.form=function(){return new e()};q.form.Class=e;q.fields={specs:(function(){var Q={};try{Q.required=q.spec(function(S){return(!q.isNullOrEmpty(S))&&/^.+$/.test(S)}),Q.optional=q.spec(function(S){return q.isNullOrEmpty(S)}),Q.currency=q.spec(function(S){return/^[\w\$]?(\d+|(\d{1,3}(,\d{3})*))(\.\d{2})?$/.test(S)});Q.date=q.spec(function(S){return/^\d{1,2}\/\d{1,2}\/(\d{2}|\d{4})$/.test(S)});Q.alpha=q.spec(function(S){return/^[A-Za-z]+$/.test(S)});Q.numeric=q.spec(function(S){return/^\d+$/.test(S)});Q.alphaNumeric=q.spec(function(S){return/^[A-Za-z\d]+$/.test(S)});Q.phone=q.spec(function(S){return/^\d{10,11}|(((1\s)?\(\d{3}\)\s?)|((1\-)?\d{3}\-))\d{3}\-\d{4}$/.test(S)});Q.ssn=q.spec(function(S){return/^(\d{9}|(\d{3}\-\d{2}\-\d{4}))$/.test(S)});Q.email=q.spec(function(S){return/^\w+(\.\w+)?@\w+(\.\w+)?\.[A-Za-z0-9]{2,}$/.test(S)})}catch(R){}finally{return Q}})()};q.ku.localization={en:{day:{name:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},abbr:{0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat"}},month:{name:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},abbr:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"}}},sp:{day:{name:{0:"domingo",1:"lunes",2:"martes",3:"mi&#0233;rcoles",4:"jueves",5:"viernes",6:"s�bado"},abbr:{0:"dom",1:"lun",2:"mar",3:"mi&#0233;",4:"jue",5:"vie",6:"s&#0225;b"}},month:{name:{1:"enero",2:"febrero",3:"marzo",4:"abril",5:"mayo",6:"junio",7:"julio",8:"agosto",9:"septiembre",10:"octubre",11:"noviembre",12:"diciembre"},abbr:{1:"ene",2:"feb",3:"mar",4:"abr",5:"may",6:"jun",7:"jul",8:"ago",9:"sep",10:"oct",11:"nov",12:"dic"}}}};var a=[],k=function(){var S=[],T=this.lazyLoad;function R(){var X=a,V=X.length;while(V--){var U=X[V],W=U.f,Z=U.b;try{W()}catch(Y){if(Z&&T){S[S.length]=W}}}}function Q(){var U=S.length;while(U--){var V=S[U];try{V()}catch(W){throw new Error(W)}}}R();if(T){Q()}};if(q.ku.browser().isIE){document.onreadystatechange=function(){if(/complete|loaded/.test(document.readyState)){k()}}}else{q.evt.add(document,"DOMContentLoaded",k,q)}})($);(function(aN){if(!aN){aN={}}aN.ku.equations={cycle:function(a5,a7,a6,a4,a3){return new aN.coord(this.sin(a5.x,a7,a6),this.cos(a5.y,a4,a3))},cos:function(a5,a4,a3){return a5+Math.cos(a4)*a3},cosH:function(a5,a4,a3){return new aN.coord(this.cos(a5.x,a4,a3),a5.y)},cosV:function(a5,a4,a3){return new aN.coord(a5.x,this.cos(a5.y,a4,a3))},sin:function(a5,a4,a3){return a5+Math.sin(a4)*a3},sinH:function(a5,a4,a3){return new aN.coord(this.sin(a5.x,a4,a3),a5.y)},sinV:function(a5,a4,a3){return new aN.coord(a5.x,this.sin(a5.y,a4,a3))}};aN.anime={algorithms:{ease:{}}};var aX=function(a3){this._ease=a3||0.1};aX.prototype={calculate:function(a4,a3){return(a3-a4)*this._ease}};aN.anime.algorithms.ease.linear=function(a3){return new aX(a3)};var aP=function(){};aP.prototype={calculate:function(a4,a3){return a3-a4}};aN.anime.algorithms.jump=function(){return new aP()};var r=function(a4,a3){this._spring=a4||0.4;this._mu=a3||0.6};r.prototype={calculate:function(a9,a5,a8){var a4=this._spring,a6=a8,a3=this._mu,ba=a5-a9,a7=ba*a4;a6+=a7;a6*=a3;return a6}};aN.anime.algorithms.spring=function(a4,a3){return new r(a4,a3)};function a0(a3){this._context=a3}a0.prototype={findCoord:function(a5){var a3=this._context,a4=aN.touch().canRead(a5)?aN.touch():aN.mouse();return a4.documentCoord(a5).subtract(a3.hitCoord()).subtract(a3.hitOffset()).add(a3.hitBoundedOffet())}};function D(a3){this._context=a3}D.prototype={findCoord:function(a5){var a3=this._context,a4=aN.touch().canRead(a5)?aN.touch():aN.mouse();return a3.hitSize().add(a4.documentCoord(a5).subtract(a3.hitCoord()).subtract(a3.hitOffset()))}};function aL(a3){this._context=a3}aL.prototype={findCoord:function(a5){var a3=this._context,a4=aN.touch().canRead(a5)?aN.touch():aN.mouse();return a3.hitCoord().add(a3.hitOffset()).subtract(a4.documentCoord(a5)).add(a3.hitScrollOffset())}};var aA={};function am(a3){am.base.call(this,a3);this._mouseEvt=aN.uid("dragger");this._touchEvt=aN.uid("toucher");this._documentBody=aN.dom(document.body);this._onGrab=aN.observer();this._onDrag=aN.observer();this._onDrop=aN.observer();this._constrainX=false;this._constrainY=false;this._boundX=0;this._boundY=0;this._lastPoint=aN.coord.zero();this._bearing=aN.vector.zero();this._document=aN.dom(document);this.state(new aA.dropped()).dragger().dragOffset(aN.coord.zero()).ontouchstart(this.grab,this,this._touchEvt).onmousedown(this.grab,this,this._mouseEvt)}am.prototype={document:function(){return this._document},hitSize:function(a3){return this.property("hitSize",a3)},hitCoord:function(a3){return this.property("hitCoord",a3)},hitOffset:function(a3){return this.property("hitOffset",a3)},dragOffset:function(a3){return this.property("dragOffset",a3)},hitScrollOffset:function(a3){return this.property("hitScrollOffset",a3)},hitBoundedOffet:function(a3){return this.property("hitBoundedOffet",a3)},actor:function(){return this.get("actor")},strategy:function(){return this.get("strategy")},bearing:function(){return this.get("bearing")},bearingUp:function(){return this.bearing().y()<0},bearingDown:function(){return this.bearing().y()>0},bearingLeft:function(){return this.bearing().x()<0},bearingRight:function(){return this.bearing().x()>0},constrainX:function(){if(this._constrainX){return this}this._constrainX=true;this._boundX=this.boundedOffset().x();return this},unconstrainX:function(){this._constrainX=false},constrainY:function(){if(this._constrainY){return this}this._constrainY=true;this._boundY=this.boundedOffset().y();return this},unconstrainY:function(){this._constrainY=false},state:function(a3){return this.set("state",a3.context(this))},dragCoord:function(a5){var a8=this.strategy().findCoord(a5),a4=this.dragOffset(),a3=(this._constrainX)?this._boundX:a8.x()+a4.x(),a7=(this._constrainY)?this._boundY:a8.y()+a4.y(),a6=aN.coord(a3,a7);this._bearing=a6.distanceFrom(this._lastPoint);this._lastPoint=a6;return a6},dragger:function(){return this.set("actor",aN.pinner(this.dom())).set("strategy",new a0(this))._setType("dragger")},sizer:function(){return this.set("actor",aN.sizer(this.dom())).set("strategy",new D(this))._setType("sizer")},scroller:function(){return this.set("actor",aN.scroller(this.dom())).set("strategy",new aL(this))._setType("scroller")},grab:function(a3){this._onGrab.notify(a3);this._state.grab(a3);return this},drag:function(a3){this._onDrag.notify(a3);this._state.drag(a3);return this},drop:function(a3){this._onDrop.notify(a3);this._state.drop(a3);this._bearing=aN.vector.zero();return this},onGrab:function(a4,a3,a5){this._onGrab.add(a4,a3,a5);return this},onDrag:function(a4,a3,a5){this._onDrag.add(a4,a3,a5);return this},onDrop:function(a4,a3,a5){this._onDrop.add(a4,a3,a5);return this},destroy:function(){this._onGrab.clear();this._onDrag.clear();this._onDrop.clear();this.removeEvent(this._mouseEvt).removeEvent(this._touchEvt)},disableSelect:function(a4){document.onselectstart=function(){return false};if(!aN.exists(window.getSelection)){return this}this._mouseDisableId=aN.uid("disable");this._touchDisableId=aN.uid("disable");function a3(){window.getSelection().removeAllRanges()}this._documentBody.onmousemove(a3,null,this._mouseDisableId).ontouchmove(a3,null,this._touchDisableId);return this},enableSelect:function(){document.onselectstart=null;var a3=this._mouseDisableId,a4=this._touchDisableId,a5=this._documentBody;if(aN.exists(a3)){a5.removeEvent(a3)}if(aN.exists(a4)){a5.removeEvent(a4)}this._mouseDisableId=null;this._touchDisableId=null;return this},_setType:function(a3){this._clearType().addClass(aN.str.format("ku-dragger-{0}",a3));return this},_clearType:function(){this.removeClass("ku-dragger-dragger").removeClass("ku-dragger-sizer").removeClass("ku-dragger-scoller");return this}};aN.ext(am,aN.dom.Class);aN.dnd=function(a3){return new am(a3)};aA.dropped=function(){aA.dropped.base.call(this,aA)};aA.dropped.prototype={grab:function(a6){aN.evt.mute(a6);var a3=this.context(),a5=aN.touch().canRead(a6)?aN.touch():aN.mouse(),a4=a5.documentCoord(a6).subtract(a3.offset());a3.document().ontouchmove(a3.drag,a3,aN.uid()).ontouchend(a3.drop,a3,aN.uid()).onmousemove(a3.drag,a3,aN.uid()).onmouseup(a3.drop,a3,aN.uid());a3.disableSelect().addClass("ku-dragger-grabbed").hitSize(a3.outerDims()).hitCoord(a4).hitOffset(a3.offset()).hitScrollOffset(a3.scrollOffset()).hitBoundedOffet(a3.boundedOffset()).actor().to(a3.dragCoord(a6));this.state("grabbed")},drag:function(){return},drop:function(){return}};aN.ext(aA.dropped,aN.abstractState);aA.grabbed=function(){aA.grabbed.base.call(this,aA)};aA.grabbed.prototype={grab:function(){return},drag:function(a4){aN.evt.mute(a4);var a3=this.context();a3.actor().to(a3.dragCoord(a4));this.context().redraw()},drop:function(a3){this.context().enableSelect().removeClass("ku-dragger-grabbed").document().clearEvents();this.state("dropped")}};aN.ext(aA.grabbed,aN.abstractState);function g(a3){g.base.call(this,a3);this._onEnd=aN.observer();this.linear()}g.prototype={$to:function(a3){return},$moveTo:function(a3){return},$done:function(){this._onEnd.notify();return this},algorithm:function(a3){this.$algorithm=a3;return this},linear:function(a3){return this.algorithm(aN.anime.algorithms.ease.linear(a3))},spring:function(a4,a3){this.algorithm(aN.anime.algorithms.spring(a4,a3))},stop:function(){if(!aN.exists(this.$tween)){return this}this.$tween.stop();return this},to:function(a3){this.stop().$to(a3).$done();return this},moveTo:function(a3){this.stop().$moveTo(a3);return this},onEnd:function(a4,a3){if(!aN.exists(a4)){return this}this._onEnd.add(a4,a3);return this}};aN.ext(g,aN.dom.Class);function B(a3){aN.dom(a3).addClass("ku-fader");B.base.call(this,a3)}B.prototype={$to:function(a3){var a5=this.dom(),a4=aN.dom(a5);a4.style("opacity",a3*0.01);return this},$moveTo:function(a3){var a5=this.dom(),a4=aN.dom(a5),a6=a4.style("opacity")||1;this.$tween=aN.tween(function(a7){a4.style("opacity",a7*0.01)},a6,a3,this.$algorithm).onEnd(this.$done,this).start(a5)}};aN.ext(B,g);aN.fader=function(a3){return new B(a3)};function aj(a3){aN.dom(a3).addClass("ku-fitter");aj.base.call(this,a3)}aj.prototype={$to:function(a3){var a5=this.dom(),a4=aN.dom(a5);a4.style("width",a3.x()+"px");a4.style("height",a3.y()+"px");return this},$moveTo:function(a6){var a4=this.dom(),a3=aN.dom(a4),a5=a3.outerDims();this.$tween=aN.tween(function(a7){a3.style("width",a7.x()+"px");a3.style("height",a7.y()+"px")},a5,aw(this,a6),this.$algorithm).onEnd(this.$done,this).start(a4)}};aN.ext(aj,g);function aw(a3,a5){var a6=a5.y()/a5.x(),a4=aN.dom(a3.dom()),ba=a4.outerDims(),a7=ba.y()/ba.x(),bb=isNaN(a7)?1:a7,a9=ba.x(),a8=ba.y();if((bb<a6)||(bb==a6)){a9=a5.x();a8=a5.x()*a7}if(bb>a6){a9=a5.y()/a7;a8=a5.y()}return aN.coord(a9,a8)}aN.fitter=function(a3){return new aj(a3)};function o(a3){aN.dom(a3).addClass("ku-pinner");o.base.call(this,a3)}o.prototype={$to:function(a3){var a5=this.dom(),a4=aN.dom(a5);a4.style("left",a3.x()+"px");a4.style("top",a3.y()+"px");return this},$moveTo:function(a9){var a7=this.dom(),a6=aN.dom(a7),a5=a6.offset(),a4=aN.findOffset(a7.parentNode),a3=(aN.coord.canParse(a4))?aN.coord.parse(a4):aN.coord.zero(),a8=a5.subtract(a3);this.$tween=aN.tween(function(ba){a6.style("left",ba.x()+"px");a6.style("top",ba.y()+"px")},a8,a9,this.$algorithm).onEnd(this.$done,this).start(a7)}};aN.ext(o,g);aN.pinner=function(a3){return new o(a3)};function V(a3){aN.dom(a3).addClass("ku-scoller");V.base.call(this,a3)}V.prototype={$to:function(a3){var a5=this.dom(),a4=aN.dom(a5);a4.style("scrollLeft",a3.x());a4.style("scrollTop",a3.y());return this},$moveTo:function(a9){var a7=this.dom(),a6=aN.dom(a7),a5=a6.scrollOffset(),a4=aN.findOffset(a7.parentNode),a3=(aN.coord.canParse(a4))?aN.coord.parse(a4):aN.coord.zero(),a8=a5.subtract(a3);this.$tween=aN.tween(function(ba){a6.style("scrollLeft",ba.x());a6.style("scrollTop",ba.y())},a8,a9,this.$algorithm).onEnd(this.$done,this).start(a7)}};aN.ext(V,g);aN.scroller=function(a3){return new V(a3)};function K(a3){aN.dom(a3).addClass("ku-sizer");K.base.call(this,a3)}K.prototype={$to:function(a3){var a5=this.dom(),a4=aN.dom(a5);a4.style("width",a3.x()+"px");a4.style("height",a3.y()+"px");return this},$moveTo:function(a6){var a4=this.dom(),a3=aN.dom(a4),a5=a3.outerDims();this.$tween=aN.tween(function(a7){a3.style("width",a7.x()+"px");a3.style("height",a7.y()+"px")},a5,a6,this.$algorithm).onEnd(this.$done,this).start(a4)}};aN.ext(K,g);aN.sizer=function(a5,a4,a3){return new K(a5,a4,a3)};function aS(a3,a4){aN.dom(a3).addClass("ku-styler");aS.base.call(this,a3);this._prop=a4}aS.prototype={$moveTo:function(a5){var a9=this.dom(),a8=aN.dom(a9),a6=this._prop,a7=a8.style(a6),a3=aN.ku.style,a4=a3.getUnit(a7)||"",ba=a3.toNumber(a7);this.$tween=aN.tween(function(bb){a8.style(a6,bb+a4)},ba,a5,this.$algorithm).onEnd(this.$done,this).start(a9)}};aN.ext(aS,g);aN.styler=function(a3,a4){return new aS(a3,a4)};function ae(a4,a3){ae.base.call(this,a3);this._listeners=aN.observer();this._ticks=0;this.fps(a4||30)}ae.prototype={fps:function(a3){this._interval=1000/a3;return this.property("fps",a3)},interval:function(){return this.get("interval")},listeners:function(){return this.get("listeners")},ticks:function(){return this.get("ticks")},start:function(){this._state.start();return this},stop:function(){this._state.stop();return this},add:function(a4,bb,a3,a5){var a8=this,ba=a5||1,a9=a3||aN.uid("timeline"),a7=function(){if(!a8._ticks%ba==0){return}a4();a6=a4},a6=(!a5)?a4:a7;this._listeners.add(a6,bb,a9);return this},remove:function(a3){this._listeners.remove(a3);return this},clear:function(){this._listeners.clear();return this},tick:function(){this._ticks++;return this}};aN.ext(ae,aN.abstractContext);aN.timeline=function(){return M};ae.started=function(){ae.started.base.call(this,ae)};ae.started.prototype={start:function(){return},stop:function(){clearTimeout(ku_timeline);ku_timeline=null;this.state("stopped")}};aN.ext(ae.started,aN.abstractState);ae.stopped=function(){ae.stopped.base.call(this,ae)};ae.stopped.prototype={start:function(){var a5=this.context(),a4=a5.interval(),a3=function(){a5.tick().listeners().notify();ku_timeline=setTimeout(a3,a4)};a3();this.state("started")},stop:function(){return}};aN.ext(ae.stopped,aN.abstractState);var M=new ae(30,new ae.stopped()).start();var al=function(a6,a5,a3,a4){this.$method=a6;this.$current=a5;this.$end=a3;this.$algorithm=a4;this.$value=0;this._onEnd=aN.observer();this._id=aN.uid("tween")};al.prototype={$exec:function(){return},$done:function(){this._onEnd.notify()},start:function(){aN.timeline().add(this.$exec,this,this._id);return this},stop:function(){aN.timeline().remove(this._id);return this},onEnd:function(a4,a3){this._onEnd.add(a4,a3);return this},clear:function(){this._onEnd.clear();return this}};aN.ext(al,aN.Class);var an=function(a6,a5,a3,a4){an.base.call(this,a6,a5,a3,a4);this.$value=aN.coord.zero()};an.prototype={$exec:function(){var a9=this.$method,a8=this.$current,a3=this.$end;var a6=this.$algorithm.calculate(a8.x(),a3.x(),this.$value.x());var a4=this.$algorithm.calculate(a8.y(),a3.y(),this.$value.y()),a5=aN.coord(a6,a4),a7=a3.abs().subtract(a8.abs());if((Math.abs(a6)<0.1)&&(a7.x()<1)&&(Math.abs(a4)<0.1)&&(a7.y()<1)){a9(a3);this.stop()._onEnd.notify();return}this.$current=a8.add(a5);this.$value=a5;a9(this.$current)}};aN.ext(an,al);var a=function(a6,a5,a3,a4){a.base.call(this,a6,a5,a3,a4)};a.prototype={$exec:function(){var a6=this.$method,a5=this.$current,a3=this.$end,a4=this.$algorithm.calculate(a5,a3,this.$value);if((Math.abs(a4)<0.1)&&(Math.abs(a3-a5)<1)){a6(a3);this.stop().$done();return}this.$current=a5+a4;this.$value=a4;a6(this.$current)}};aN.ext(a,al);aN.tween=function(a6,a5,a3,a4){return(aN.isNumber(a5)&&aN.isNumber(a3))?new a(a6,a5,a3,a4):new an(a6,a5,a3,a4)};function U(a7,a6,a3,a4,a8,a5){U.base.call(this,a7);this.id(aN.uid("jsx-cell")).cIdx(a6).cKey(a3).rIdx(a4).rKey(a8).value(a5)}U.prototype={id:function(a3){return this.property("id",a3)},value:function(a3){return this.property("value",a3)},cIdx:function(a3){if(aN.exists(a3)){this.dom().cIdx=a3}return this.property("cIdx",a3)},rIdx:function(a3){if(aN.exists(a3)){this.dom().rIdx=a3}return this.property("rIdx",a3)},cKey:function(a3){if(aN.exists(a3)){this.dom().cKey=a3}return this.property("cKey",a3)},rKey:function(a3){if(aN.exists(a3)){this.dom().rKey=a3}return this.property("rKey",a3)}};aN.ext(U,aN.dom.Class);aN.cell=function(a7,a6,a3,a4,a8,a5){return new U(a7,a6,a3,a4,a8,a5)};aN.cell.Class=U;function Z(a7,a4,a3,a5,a6){Z.base.call(this,a7);this.id(aN.uid()).col(a4).index(a3).key(a5).value(a6);this._cells=aN.hash()}Z.prototype={id:function(a3){return this.property("id",a3)},col:function(a3){return this.property("col",a3)},value:function(a3){if(aN.exists(a3)){this.content(a3)}return this.property("value",a3)},index:function(a3){if(aN.exists(a3)){this.dom().cIdx=a3}return this.property("index",a3)},key:function(a3){if(aN.exists(a3)){this.dom().cKey=a3}return this.property("key",a3)},findCell:function(a3){return this._cells.find(a3)},listCells:function(){return this._cells.listValues()},addCell:function(a3){this._cells.add(a3.rKey(),a3);return this},removeCell:function(a3){var a4=this._cells;a4.remove(a3.rKey());if(a4.isEmpty()){aN.dom(this._col).detach();this.detach()}return this},};aN.ext(Z,aN.dom.Class);aN.column=function(a7,a4,a3,a5,a6){return new Z(a7,a4,a3,a5,a6)};aN.column.Class=Z;function ap(a4){aN.cast(this,a4);this._dri=new aN.iterator(this.rows.listValues());this.helper=aN.create({tr:{"class":"ku-table-dragRow-helper"}});aN.slider(this.helper,null,null,null,null,null,"dragger","vertical");this._isMoving=false;this._hitPoint;this._moveDom;function a3(a5){return aN.cast(aN.coord.parse(aN.findOffset(this.dom)),aN.point)}this._dri.foreach(function(a5){aN.evt.add(a5.dom,"mouseover",function(){if(!this._isMoving){return}var ba=a5.dom,a6=this.body,a7=this.helper,a8=this._hitPoint,a9=a3(ba);if(!ba.nextSibling){a6.appendChild(a7)}else{if(a9.isAbove(a8)){a6.insertBefore(a7,ba)}else{a6.insertBefore(a7,ba.nextSibling)}}this._hitPoint=a9},this);aN.dnd(a5.dom,function(){this.helper=a5.dom;this._isMoving=true;this._hitPoint=a3(a5.dom);this._moveDom=a5.dom;this.body.insertBefore(this.helper,a5.dom);aN.ku.css.addClass(this.body,"ku-table-draggableRow-dragging");aN.ku.css.addClass(this._moveDom,"ku-table-draggableRow-moveDom")},null,function(){aN.ku.css.removeClass(this.body,"ku-table-draggableRow-dragging");aN.ku.css.removeClass(this._moveDom,"ku-table-draggableRow-moveDom");aN.ku.swapDom(this.helper,this._moveDom);this._isMoving=false;this._moveDom=null;this.format()},this)},this)}aN.draggableRowDecorator=function(a3){return new ap(a3)};function aH(a3){aN.cast(this,a3);this._sci=new aN.iterator(this.columns.listValues());this._sci.foreach(function(a6){var a5=a6.dom,a4=aN.create({a:{"class":"ku-table-col-sizer"}});new aN.slider(a5,a4,null,null,null,null,"sizer","horizontal");a5.appendChild(a4)})}function aK(a3){aN.cast(this,a3);this._isAsc=false;this._asc=new aN.sorter(sorter.strategy.asc);this._des=new aN.sorter(sorter.strategy.des);this._sortci=new aN.iterator(this.columns.listValues());this._sortci.foreach(function(a6){var a4=new aN.iterator(a6.cells.listValues()),a5=aN.create({a:{"class":"ku-table-col-sorter"}});a6.dom.appendChild(a5);aN.evt.add(a5,"click",function(){var bf=[],a7=this._isAsc,bg=(a7)?this._asc:this._des,a9="ku-table-col-sorter-{0}",bc=aN.str.format(a9,"asc"),ba=aN.str.format(a9,"dec"),be=(a7)?bc:ba;a4.foreach(function(bh){bf[bf.length]=bh.dom});this._isAsc=!this._isAsc;var bd=bg.sort(bf),a8=bd.length,bb=this.body;aN.clearNode(bb);while(a8--){bb.appendChild(this.rows.find(bd[i].rIdx).dom)}aN.ku.css.removeClass(a5,bc);aN.ku.css.removeClass(a5,ba);aN.ku.css.addClass(a5,be);this.format()},this)},this)}function X(){X.base.call(this)}X.prototype={table:function(a3){return this.set("table",a3)},createColumn:function(a4,a5,a6){var a3=aN.create({col:{}}),a7=aN.create({th:{"ku-key":a5},content:aN.create({span:{"class":"ku-table-head-content"},content:a6})});return aN.column(a7,a3,a4,a5,a6)},createRow:function(a3,a4){var a5=aN.create({tr:{"class":"ku-table-row"}});return aN.row(a5,a3,a4)},createCell:function(a8,a7,a4,a6,ba){var a5=this._table,a9=aN.create({td:{"class":"ku-table-cell"},content:a8}),a3=aN.cell(a9,a7,a4,a6,ba,a8).onclick(function(){a5.selectCell(a3)},this);return a3}};aN.ext(X,aN.Class);function aI(a5,a3,a4){aI.base.call(this,a5);this.id(aN.uid()).index(a3).key(a4);this._cells=aN.hash()}aI.prototype={id:function(a3){return this.property("id",a3)},index:function(a3){if(aN.exists(a3)){this.dom().rIdx=a3}return this.property("index",a3)},key:function(a3){if(aN.exists(a3)){this.dom().rKey=a3}return this.property("key",a3)},findCell:function(a3){return this._cells.find(a3)},listCells:function(){return this._cells.listValues()},addCell:function(a3){this._dom.appendChild(a3.dom());this._cells.add(a3.cKey(),a3);return this},removeCell:function(a3){this._dom.removeChild(a3.dom());this._cells.remove(a3.cKey());return this}};aN.ext(aI,aN.dom.Class);aN.row=function(a6,a3,a4,a5){return new aI(a6,a3,a4,a5)};aN.row.Class=aI;function ao(a6){var ba=aN.create({table:{"class":"ku-table",cellspacing:0}});ao.base.call(this,ba);var a5=aN.create({colgroup:{"class":"ku-table-colgroup"}}),a4=aN.create({caption:{"class":"ku-table-caption"}}),a8=aN.create({thead:{"class":"ku-table-head"}}),a9=aN.create({tr:{"class":"ku-table-head-row"}}),a3=aN.create({tbody:{"class":"ku-table-body"}}),a7=aN.create({tfoot:{"class":"ku-table-foot"}});this._columns=new aN.hash();this._rows=new aN.hash();this._cells=new aN.hash();this._onCellSelect=aN.observer();this.appendChild(a5).colgroup(a5).appendChild(a4).caption(a4).appendChild(a8).head(a8).appendChild(a9).headRow(a9).appendChild(a3).body(a3).appendChild(a7).foot(a7).factory(a6||new X()).head().appendChild(this.headRow())}ao.prototype={title:function(a3){if(aN.isString(a3)){this.caption().innerHTML=a3}else{if(aN.exists(a3)){this.caption().appendChild(a3)}}return this.property("title",a3)},factory:function(a3){return this.property("factory",a3.table(this))},caption:function(a3){return this.property("caption",a3)},colgroup:function(a3){return this.property("colgroup",a3)},head:function(a3){return this.property("head",a3)},headRow:function(a3){return this.property("headRow",a3)},body:function(a3){return this.property("body",a3)},foot:function(a3){return this.property("foot",a3)},listColumns:function(){return this._columns.listValues()},listRows:function(){return this._rows.listValues()},listCells:function(){return this._cells.listValues()},selectCell:function(a3){this._onCellSelect.notify(a3);return this},onCellSelect:function(a4,a3){this._onCellSelect.add(a4,a3);return this},addColumn:function(a4,a7,a6){var a3=this._columns,a5=this._rows;if(a3.containsKey(a4)){return this._updateColumn(a4,a7,a6)}else{return this._addColumn(a4,a7,a6)}},_addColumn:function(a3,a6,a5){var a4=this._factory.createColumn(aN.uid(),a3,a5);this._columns.add(a4.key(),a4);this._rows.listValues().each(function(a7){this.addCell(a7,a4,a6[a7.key()])},this);this._colgroup.appendChild(a4.col());this._headRow.appendChild(a4.dom());return this},_updateColumn:function(a3,a6,a5){var a4=this._columns.find(a3);this._rows.listValues().each(function(a7){this.findCell(a7.key(),a4.key()).value(a6[a7.key()])},this);if(aN.exists(a5)){a4.value(a5)}return this},findColumn:function(a3){return this._columns.find(a3)},removeColumn:function(a3){var a5=this._rows,a4=this.findColumn(a3);if(!aN.exists(a4)){return this}a5.listValues().each(function(a6){this.removeCell(a4.findCell(a6.key()))},this);this._columns.remove(a4.key());return this},addRow:function(a4,a6){var a5=this._rows,a3=this._columns;if(a5.containsKey(a4)){return this._updateRow(a4,a6)}else{return this._addRow(a4,a6)}},_addRow:function(a3,a4){var a5=this._factory.createRow(aN.uid(),a3);this._rows.add(a5.key(),a5);this._columns.listValues().each(function(a6){this.addCell(a5,a6,a4[a6.key()])},this);this.body().appendChild(a5.dom());return this},_updateRow:function(a3,a4){var a5=this._rows.find(a3);this._columns.listValues().each(function(a6){this.findCell(a5.key(),a6.key()).value(a4[a6.key()])},this);return this},findRow:function(a3){return this._rows.find(a3)},removeRow:function(a4){var a3=this._columns,a5=this.findRow(a4);if(!aN.exists(a5)){return this}a3.listValues().each(function(a6){this.removeCell(a5.findCell(a6.key()))},this);this._rows.remove(a5.key());return this},addCell:function(a6,a4,a5){var a3=this._factory.createCell(a5,a4.index(),a4.key(),a6.index(),a6.key());a4.addCell(a3);a6.addCell(a3);this._cells.add(a3.id(),a3);return this},findCellById:function(a3){return this._cells.find(a3)},findCell:function(a6,a4){var a3=this._cells.listValues(),a5;a3.each(function(a7){if((a7.rKey()==a6)&&(a7.cKey()==a4)){a5=a7;a3.quit()}});return a5},removeCell:function(a3){this._cells.remove(a3.id());this._columns.find(a3.cKey()).removeCell(a3);this._rows.find(a3.rKey()).removeCell(a3);return this},format:function(){var a3=0,a4="ku-table-row-even",a5="ku-table-row-odd",a6=function(){(a3%2==0)?a4:a5};this._rows.each(function(a7){a7.removeClass(a4).removeClass(a5).addClass(a6());a3++})},toObject:function(){return{title:this.title(),columns:this._columns.toObject(),rows:this._rows.toObject()}}};aN.ext(ao,aN.dom.Class);aN.table=function(a3){return new ao(a3)};aN.table.Class=ao;ao.parseDom=function(a8){var a4=function(bb,ba){return bb.getElementsByTagName(ba)};ao=aN.ele(a8),cols=a4(a4((a4(ao,"thead")[0]),"tr")[0],"th"),rows=a4((a4(ao,"tbody")[0]),"tr"),caption=a4(ao,"caption")[0],title=(!caption)?"":caption.innerHTML,t=new aN.table(title),l=cols.length,m=rows.length,c=[];while(i--){var a7=cols[i],a3=aN.ku.getText(a7)||aN.uid("table-column");c[c.length]=a3;t.addColumn(a3,a7.innerHTML)}while(m--){var a5=a4(rows[j],"td"),a9=a5.length,a6={};while(a9--){a6[c[a3]]=a5[a3].innerHTML}t.addRow(a6)}return t};ao.parseObject=function(a5){var a3=new aN.table(a5.title),a7=a5.columns,a4=a5.rows;for(var a6 in a7){a3.addColumn(a6,a7[a6])}for(var a6 in a4){a3.addRow(a4[a6])}return a3};var y=function(){y.base.call(this,aN.create({div:{"class":"ku-calendar"}}));var a3=aN.create({div:{"class":"ku-sheet"}});this._sheetContainer=aN.dom(a3);this._onShowDates=aN.observer();this._onShowMonths=aN.observer();this._onShowYears=aN.observer();this._onSelect=aN.observer();this._sheet;this.dayPoint(aN.dayPoint.today()).localization(aN.ku.localization.en).sheetFactory(aN.clickableSheetFactory()).dom().appendChild(a3)};y.prototype={dayPoint:function(a3){return this.property("dayPoint",a3)},localization:function(a3){return this.property("localization",a3)},sheetFactory:function(a3){return this.set("sheetFactory",a3)},isShowingDates:function(){return this._isShowingDates},isShowingMonths:function(){return this._isShowingMonths},isShowingYears:function(){return this._isShowingYears},nextDay:function(){this.dayPoint(this.dayPoint().nextDay());return this},prevDay:function(){this.dayPoint(this.dayPoint().prevDay());return this},nextMonth:function(){this.dayPoint(this.dayPoint().nextMonth());return this},prevMonth:function(){this.dayPoint(this.dayPoint().prevMonth());return this},nextYear:function(){this.dayPoint(this.dayPoint().nextYear());return this},prevYear:function(){this.dayPoint(this.dayPoint().prevYear());return this},showDates:function(){return this._showSheet("createDatesheet")._currentView(false,false,true)},showMonths:function(){return this._showSheet("createMonthsheet")._currentView(false,true,false)},showYears:function(){return this._showSheet("createYearsheet")._currentView(true,false,false)},findCell:function(a3){return this._sheet.findCell(a3)},each:function(a4,a3){this._sheet.each(a4,a3);return this},select:function(a3){this._sheet.select(a3);return this},onSelect:function(a4,a3){this._onSelect.add(a4,a3);return this},onShowDates:function(a4,a3){this._onShowDates.add(a4,a3);return this},onShowMonths:function(a4,a3){this._onShowMonths.add(a4,a3);return this},onShowYears:function(a4,a3){this._onShowYears.add(a4,a3);return this},_currentView:function(a4,a3,a5){this._isShowingYears=a4;this._isShowingMonths=a3;this._isShowingDates=a5;if(a4){this._onShowYears.notify()}if(a3){this._onShowYears.notify()}if(a5){this._onShowDates.notify()}return this},_showSheet:function(a5){var a3=this._sheet;if(aN.exists(a3)){a3.destroy()}var a4=this._sheetFactory[a5](this.dayPoint(),this._localization).onSelect(this._onSelect.notify,this._onSelect);this._sheetContainer.clear().appendChild(a4.dom());this._sheet=a4;return this}};aN.ext(y,aN.dom.Class);aN.calendar=function(){return new y()};var aY=function(a6){aY.base.call(this,aN.create({div:{"class":"ku-calendar-controls"}}));this._calendar=a6;var a8=aN.dom(aN.create({div:{"class":"ku-calendar-title"}})),a5=aN.dom(aN.create({button:{"class":"ku-calendar-month"}})).onclick(this.showMonths,this),a4=aN.dom(aN.create({button:{"class":"ku-calendar-year"}})).onclick(this.showYears,this,this),a3=aN.dom(aN.create({button:{"class":"ku-calendar-prevButton"}})).onclick(function(){this._prevAction()},this),a7=aN.dom(aN.create({button:{"class":"ku-calendar-nextButton"}})).onclick(function(){this._nextAction()},this);aN.dom(this.dom()).appendChild(a8.appendChild(a5.dom()).appendChild(a4.dom()).dom()).appendChild(a3.dom()).appendChild(a7.dom()).appendChild(a6.dom());this._title=a8;this._month=a5;this._year=a4;this._prevButton=a3;this._nextButton=a7;this._prevAction;this._nextAction;this.onSelect(this._displayDates,this)};aY.prototype={dayPoint:function(a3){var a4=this._calendar;if(!aN.exists(a3)){return a4.dayPoint()}a4.dayPoint(a3);return this},localization:function(a4){var a3=this._calendar;if(!aN.exists(a4)){return a3.localization()}a3.localization(a4);return this},sheetFactory:function(a3){this._calendar.sheetFactory(a3);return this},nextDay:function(){this._calendar.nextDay();return this},prevDay:function(){this._calendar.prevDay();return this},nextMonth:function(){this._calendar.nextMonth();return this},prevMonth:function(){this._calendar.prevMonth();return this},nextYear:function(){this._calendar.nextYear();return this},prevYear:function(){this._calendar.prevYear();return this},showDates:function(){var a5=this._calendar,a3=a5.localization().month.name,a4=a5.dayPoint();a5.showDates();this._month.html(a3[a4.month()]);this._year.html(a4.year());this._prevAction=this._prevMonth;this._nextAction=this._nextMonth;return this},showMonths:function(){this._calendar.showMonths();var a3=function(){return};this._prevAction=a3;this._nextAction=a3;return this},showYears:function(){this._calendar.showYears();this._prevAction=this._prevYears;this._nextAction=this._nextYears;return this},findCell:function(a3){return this._calendar.findCell(a3)},each:function(a4,a3){this._calendar.each(a4,a3);return this},select:function(a3){this._calendar.select(a3);return this},onSelect:function(a4,a3){this._calendar.onSelect(a4,a3);return this},onShowDates:function(a4,a3){this._calendar.onShowDates(a4,a3);return this},onShowMonths:function(a4,a3){this._calendar.onShowMonths(a4,a3);return this},onShowYears:function(a4,a3){this._calendar.onShowYears(a4,a3);return this},_prevMonth:function(){this.prevMonth().showDates()},_nextMonth:function(){this.nextMonth().showDates()},_prevYears:function(){this.dayPoint(this.dayPoint().add(-12,0,0)).showYears()},_nextYears:function(){this.dayPoint(this.dayPoint().add(12,0,0)).showYears()},_displayDates:function(a3){var ba=this._calendar,a4=ba.isShowingDates(),a9=ba.isShowingMonths(),a8=ba.isShowingYears(),a5=ba.dayPoint(),a6=a3.value(),a7;if(a8){a7=aN.dayPoint(a6.year(),a5.month(),a5.date())}if(a9){a7=aN.dayPoint(a5.year(),a6.month(),a5.date())}if(a4){a7=a6}this.dayPoint(a7);if(a8||a9||(a5.month()!=a6.month())){this.showDates()}}};aN.ext(aY,aN.dom.Class);aN.calendarControlsDecorator=function(a3){return new aY(a3)};function a2(){}a2.prototype={createDatesheet:function(a3,a4){return aN.datesheet(a3,a4,aN.table(aN.clickableDateSheetTableFactory(a3,a4)))},createMonthsheet:function(a3,a4){return aN.monthsheet(a3,a4,aN.table(aN.clickableMonthSheetTableFactory(a3,a4)))},createYearsheet:function(a3,a4){return aN.yearsheet(a3,a4,aN.table(aN.clickableYearSheetTableFactory(a3,a4)))}};aN.clickableSheetFactory=function(){return new a2()};function ac(a3,a4){ac.base.call(this);this._dayPoint=a3;this._localization=a4}ac.prototype={$setCellAction:function(a3){return a3},table:function(a3){this.$table=a3;return this.set("table",a3)},createColumn:function(a4,a5,a6){var a4=this._table.listColumns().count(),a3=aN.create({col:{}}),a7=aN.create({th:{"ku-key":a5},content:aN.create({span:{"class":"ku-table-head-content"},content:a6})});return aN.column(a7,a3,a4,a5,a6)},createRow:function(a4,a5){var a4=this._table.listRows().count(),a3=(a4%2==0)?"ku-table-row ku-table-row-even":"ku-table-row ku-table-row-odd";dom=aN.create({tr:{"class":a3}});return aN.row(dom,a4,a5)},createCell:function(a9,a3,a4,a5,a6){var bb=this._table,a8=aN.dayPoint.today(),a7=aN.create({td:{"class":aN.str.format("ku-date-day-{0} ku-date-week-{1}",a3,a5)},content:aN.str.format("<span class='ku-datesheet-cell-date'>{0}</span>",a9.date())}),ba=aN.cell(a7,a3,a4,a5,a6,a9).addClass("ku-sheet-date").id(a9.toString());if(a9.isBefore(a8)){ba.addClass("ku-datesheet-past")}if(a9.equals(a8)){ba.addClass("ku-datesheet-present")}if(a9.isAfter(a8)){ba.addClass("ku-datesheet-future")}if(a9.isWeekday()){ba.addClass("ku-datesheet-weekday")}if(a9.isWeekend()){ba.addClass("ku-datesheet-weekend")}if((a9.month()<this._dayPoint.month())||((a9.month()==12)&&(this._dayPoint.month()==1))){ba.addClass("ku-datesheet-lastMonth")}if(a9.month()==this._dayPoint.month()){ba.addClass("ku-datesheet-thisMonth")}if((a9.month()>this._dayPoint.month())||((a9.month()==1)&&(this._dayPoint.month()==12))){ba.addClass("ku-datesheet-nextMonth")}return this.$setCellAction(ba)}};aN.ext(ac,aN.Class);function ag(a3,a4){ag.base.call(this);this._dayPoint=a3;this._localization=a4}ag.prototype={$setCellAction:function(a3){return a3},table:function(a3){this.$table=a3;return this.set("table",a3)},createColumn:function(a4,a5,a6){var a4=this._table.listColumns().count(),a3=aN.create({col:{}}),a7=aN.create({th:{"ku-key":a5},content:aN.create({span:{"class":"ku-table-head-content"},content:a6})});return aN.column(a7,a3,a4,a5,a6)},createRow:function(a4,a5){var a4=this._table.listRows().count(),a3=(a4%2==0)?"ku-table-row ku-table-row-even":"ku-table-row ku-table-row-odd";dom=aN.create({tr:{"class":a3}});return aN.row(dom,a4,a5)},createCell:function(a7,a6,a4,a5,a9){var a8=aN.create({td:{"class":aN.str.format("ku-month",a6,a5)},content:this._localization.month.abbr[a7.month()]}),a3=aN.cell(a8,a6,a4,a5,a9,a7).addClass("ku-sheet-month").id(a7.month().toString());return this.$setCellAction(a3)}};aN.ext(ag,aN.Class);function d(a3,a4){d.base.call(this);this._dayPoint=a3;this._localization=a4}d.prototype={$setCellAction:function(a3){return a3},table:function(a3){this.$table=a3;return this.set("table",a3)},createColumn:function(a4,a5,a6){var a4=this._table.listColumns().count(),a3=aN.create({col:{}}),a7=aN.create({th:{"ku-key":a5},content:aN.create({span:{"class":"ku-table-head-content"},content:a6})});return aN.column(a7,a3,a4,a5,a6)},createRow:function(a4,a5){var a4=this._table.listRows().count(),a3=(a4%2==0)?"ku-table-row ku-table-row-even":"ku-table-row ku-table-row-odd";dom=aN.create({tr:{"class":a3}});return aN.row(dom,a4,a5)},createCell:function(a7,a6,a4,a5,a9){var a8=aN.create({td:{"class":aN.str.format("ku-year",a6,a5)},content:a7.year()}),a3=aN.cell(a8,a6,a4,a5,a9,a7).addClass("ku-sheet-year").id(a7.year().toString());return this.$setCellAction(a3)}};aN.ext(d,aN.Class);function aG(a3,a4){aG.base.call(this,a3,a4)}aG.prototype={$setCellAction:function(a3){return a3.onclick(function(){this.$table.selectCell(a3)},this)}};aN.ext(aG,ac);aN.clickableDateSheetTableFactory=function(a3,a4){return new aG(a3,a4)};function W(a3,a4){W.base.call(this,a3,a4)}W.prototype={$setCellAction:function(a3){return a3.onclick(function(){this.$table.selectCell(a3)},this)}};aN.ext(W,ag);aN.clickableMonthSheetTableFactory=function(a3,a4){return new W(a3,a4)};function ab(a3,a4){ab.base.call(this,a3,a4)}ab.prototype={$setCellAction:function(a3){return a3.onclick(function(){this.$table.selectCell(a3)},this)}};aN.ext(ab,d);aN.clickableYearSheetTableFactory=function(a3,a4){return new ab(a3,a4)};var Q=function(a3,a4){Q.base.call(this,a3);this.localization(a4);this._onSelect=aN.observer()};Q.prototype={$findCell:function(a3){return null},localization:function(a3){return this.property("localization",a3)},each:function(a4,a3){this.$sheet.listCells().each(a4,a3);return this},findCell:function(a3){return this.$findCell(a3)},selectCell:function(a3){if(!aN.exists(a3)){return this}this._onSelect.notify(a3);return this},select:function(a3){return this.selectCell(this.findCell(a3))},onSelect:function(a4,a3){this._onSelect.add(a4,a3);return this},destroy:function(){this.$sheet.listCells().each(function(a3){if(aN.exists(a3.deallocate)){a3.deallocate()}a3.clearEvents();return this})}};aN.ext(Q,aN.dom.Class);var h=function(a3,a5,a4){this._firstDateOfSheet=F(a3);this.$sheet=a4.onCellSelect(this.selectCell,this);h.base.call(this,this.$sheet.dom(),a5);aM(this);ak(this)};h.prototype={$findCell:function(a3){return this.$sheet.findCellById(a3.toString())}};aN.ext(h,Q);aN.datesheet=function(a3,a5,a4){return(new h(a3,a5,a4))};function F(a3){var a5=a3.firstDayOfMonth(),a6=a3.firstDayOfMonth(),a4=false;while(a6.day()>0||!a4){if(a6.day()==0){a4=true}a6=a6.prevDay()}return a6}function aM(a5){var a8=a5.localization().day.abbr,a7=a5.$sheet,a6=7,a4=0;while(a4<a6){var a3=a8[a4];a7.addColumn(a3,{},a3);a4++}}function ak(a6){var a7=a6.$sheet,a3=a6._firstDateOfSheet,a5=0;while(a5<7){var a4=az(a6,a3);a3=a3.add(0,0,7);a7.addRow(aN.uid(),a4);a5++}}function az(a4,a3){var a5=a3,a6={};a4.$sheet.listColumns().each(function(a7){a6[a7.key()]=a5;a5=a5.nextDay()});return a6}var Y=function(a3,a5,a4){this._firstDateOfSheet=aR(a3);this.$sheet=a4.onCellSelect(this.selectCell,this);Y.base.call(this,this.$sheet.dom(),a5);e(this);af(this)};Y.prototype={$findCell:function(a3){return this.$sheet.findCellById(a3.month())}};aN.ext(Y,Q);aN.monthsheet=function(a3,a5,a4){return(new Y(a3,a5,a4))};function aR(a3){return aN.dayPoint(a3.year(),1,a3.date())}function e(a6){var a4=a6.localization().month.abbr,a7=a6.$sheet,a3=4,a5=1;while(a5<=a3){a7.addColumn(a5,null,"");a5++}}function af(a6){var a7=a6.$sheet,a4=a6._firstDateOfSheet,a5=1;while(a5<=3){var a3=S(a6,a4);a4=a4.add(0,4,0);a7.addRow(aN.uid(),a3);a5++}}function S(a4,a3){var a5=a3,a6={};a4.$sheet.listColumns().each(function(a7){a6[a7.key()]=a5;a5=a5.nextMonth()});return a6}var H=function(a3,a5,a4){this._firstDateOfSheet=aq(a3);this.$sheet=a4.onCellSelect(this.selectCell,this);H.base.call(this,this.$sheet.dom(),a5);aa(this);P(this)};H.prototype={$findCell:function(a3){return this.$sheet.findCellById(a3.year())}};aN.ext(H,Q);aN.yearsheet=function(a3,a5,a4){return(new H(a3,a5,a4))};function aq(a3){return a3.add(-12,0,0)}function aa(a6){var a3=a6.localization().month.abbr,a7=a6.$sheet,a4=5,a5=0;while(a5<a4){a7.addColumn(a5,null,"");a5++}}function P(a6){var a7=a6.$sheet,a3=a6._firstDateOfSheet,a5=0;while(a5<5){var a4=au(a6,a3);a3=a3.add(5,0,0);a7.addRow(aN.uid(),a4);a5++}}function au(a4,a3){var a5=a3,a6={};a4.$sheet.listColumns().each(function(a7){a6[a7.key()]=a5;a5=a5.nextYear()});return a6}function u(a3){u.base.call(this,a3);this._id=aN.uid("dropper");this._handle=this}u.prototype={id:function(a3){return this.get("id")},value:function(a3){return this.property("value",a3)},handle:function(a3){var a4;if(aN.exists(a3)){a4=aN.dom(a3)}return this.property("handle",a4)},mouseEventId:function(a3){return this.property("mouseEventId",a3)},touchEventId:function(a3){return this.property("touchEventId",a3)},};aN.ext(u,aN.dom.Class);aN.dndScreenDropper=function(a3){return new u(a3)};var ah=function(){this._targets=aN.hash();this._droppers=aN.hash();this._onHit=aN.observer();this._lastKnownCoord;this._helper=aN.sprite(aN.create({div:{"class":"ku-dndScreen-helper"}})).onGrab(function(a4){var a3=aN.touch().canRead(a4)?aN.touch():aN.mouse();this._lastKnownCoord=a3.documentCoord(a4)},this).onDrag(function(a4){var a3=aN.touch().canRead(a4)?aN.touch():aN.mouse();this._lastKnownCoord=a3.documentCoord(a4)},this).onDrop(function(a3){this._drop(a3)},this);this._currentDropper};ah.prototype={addTarget:function(a3){this._targets.add(a3.id(),a3);return this},removeTarget:function(a3){this._targets.remove(a3.id(),a3);return this},addDropper:function(a5){var a6=aN.uid("dropperEvent"),a3=aN.uid("dropperEvent");function a4(a7){this._currentDropper=a5;this.activateHelper(a7,a5)}a5.mouseEventId(a6).touchEventId(a3).handle().onmousedown(a4,this,a6).ontouchstart(a4,this,a3);this._droppers.add(a5.id(),a5)},removeDropper:function(a3){a3.handle().removeEvent(a3.touchEventId()).removeEvent(a3.mouseEventId());this._droppers.remove(a3.id())},activateHelper:function(a4,a3){this._helper.appendTo(document.body).pinTo(a3.offset().subtract(a3.scrollOffset()).add(aN.window().scrollOffset())).content(a3.cloneNode()).grab(a4)},deactivateHelper:function(){this._helper.html("").detach();this._currentDropper=undefined},clearTargets:function(){this._targets.clear();return this},clearDroppers:function(){var a3=this._droppers;a3.listValues().each(function(a4){this.removeDropper(a4)},this);return this},clearAll:function(){this.clearTargets().clearDroppers();return this},clearListeners:function(){this._onHit.clear();return this},onHit:function(a4,a3){this._onHit.add(a4,a3);return this},_drop:function(a5){var a3=this._findHitTarget(a5),a4=this._currentDropper;if(aN.exists(a3)&&aN.exists(a4)){this._onHit.notify(a3,a4)}this.deactivateHelper()},_findHitTarget:function(a6){var a3=this._targets.listValues(),a5=aN.touch().canRead(a6)?aN.touch():aN.mouse(),a4=null,a7;try{a7=a5.documentCoord(a6)}catch(a6){a7=this._lastKnownCoord}a3.each(function(a8){if(!a8.contains(a7)){return}a4=a8;a3.quit()});return a4}};aN.dndScreen=function(){return new ah()};function ax(a3){ax.base.call(this,a3);this._id=aN.uid("target")}ax.prototype={id:function(a3){return this.get("id")},value:function(a3){return this.property("value",a3)},contains:function(a5){var a4=this.offset(),a3=a4.add(this.outerDims());return aN.rectangle(a4,a3).contains(a5)}};aN.ext(ax,aN.dom.Class);aN.dndScreenTarget=function(a3){return new ax(a3)};function aC(a3){aC.base.call(this,a3);this._isinvalid=false;this._keyup=aN.uid();this._$dom=aN.dom(this.dom());this.onInvalid(this.invalidate,this).onIsValid(this.validate,this)}aC.prototype={$clear:function(){return this.value("").validate()},tooltip:function(a3){return this.set("tooltip",a3)},invalidate:function(){if(this._isinvalid){return this}this._isinvalid=true;this._$dom.addClass("ku-field-error").onchange(this.isValid,this,this._keyup);var a3=this._tooltip;if(aN.exists(a3)){a3.show().rightOf(this.dom())}return this},validate:function(){if(!this._isinvalid){return this}this._isinvalid=false;this._$dom.removeClass("ku-field-error").removeEvent(this._keyup);var a3=this._tooltip;if(aN.exists(a3)){a3.hide()}return this}};aN.ext(aC,aN.checkbox.Class);function aD(a3){aD.base.call(this,a3);this._isinvalid=false;this._keyupid=aN.uid();this._$dom=aN.dom(this.dom());this.onInvalid(this.invalidate,this).onIsValid(this.validate,this)}aD.prototype={$clear:function(){return this.value("").validate()},tooltip:function(a3){return this.set("tooltip",a3)},watermark:function(a3){return this.set("watermark",a3)},invalidate:function(){if(this._isinvalid){return this}this._isinvalid=true;this._$dom.addClass("ku-field-error").onkeyup(this.isValid,this,this._keyupid);var a3=this._tooltip;if(aN.exists(a3)){a3.show().rightOf(this.dom())}return this},validate:function(){if(!this._isinvalid){return this}this._isinvalid=false;this._$dom.removeClass("ku-field-error").removeEvent(this._keyupid);var a3=this._tooltip;if(aN.exists(a3)){a3.hide()}return this}};aN.ext(aD,aN.field.Class);function aT(a3){aT.base.call(this,a3);this._isinvalid=false;this._keyup=aN.uid();this._$dom=aN.dom(this.dom());this.onInvalid(this.invalidate,this).onIsValid(this.validate,this)}aT.prototype={$clear:function(){return this.value("").validate()},tooltip:function(a3){return this.set("tooltip",a3)},invalidate:function(){if(this._isinvalid){return this}this._isinvalid=true;this._$dom.addClass("ku-field-error").onchange(this.isValid,this,this._keyup);var a3=this._tooltip;if(aN.exists(a3)){a3.show().rightOf(this.dom())}return this},validate:function(){if(!this._isinvalid){return this}this._isinvalid=false;this._$dom.removeClass("ku-field-error").removeEvent(this._keyup);var a3=this._tooltip;if(aN.exists(a3)){a3.hide()}return this}};aN.ext(aT,aN.select.Class);function v(a3){v.base.call(this,a3);this.tooltip(aN.tooltip().message("Invalid"))}aN.ext(v,aC);aN.fields.checkbox=function(a3){return new v(a3)};function ad(a3){ad.base.call(this,a3);this._id=aN.uid("field");this._isShow=false;this._calendar=aN.calendarControlsDecorator(aN.calendar()).onSelect(function(a4){this.value(a4.value().toString()).validate();this.hideCalendar()},this).showDates();this._calContainer=aN.tooltip().pointer(aN.sprite(aN.create({div:{"class":"ku-dayPointField-tooltip-pointer"}})).hide().dragOff()).tooltip(aN.sprite(aN.create({div:{"class":"ku-dayPointField-tooltip"}})).hide().dragOff()).message(this._calendar.dom());this._$dom=aN.dom(this.dom()).onfocus(this._focusAction,this).onkeyup(this._keyupAction,this).onkeydown(this._keydownAction,this);this.spec(aN.fields.specs.date).tooltip(aN.tooltip().message("Enter a valid date."))}ad.prototype={$read:function(){return(aN.dayPoint.tryParse(this.dom().value)||"").toString()},$write:function(a3){this.dom().value=(aN.dayPoint.tryParse(a3)||a3).toString()},showCalendar:function(){if(this._isShow){return}this._isShow=true;this._calContainer.show().at(this.dom(),["below","above"]);aN.window().onmouseup(this._hideCalendar,this,this._id);return this},hideCalendar:function(a3){this._calContainer.hide();this._calendar.detach();aN.window().remove(this._id);this._isShow=false;return this},_hideCalendar:function(a8){var a3=this._calendar,a6=a3.offset(),a5=a6.add(a3.outerDims()),a9=this._$dom,bc=a9.offset(),bb=bc.add(a9.outerDims()),a4=aN.rectangle(a6,a5),ba=aN.rectangle(bc,bb),a7=aN.mouse().documentCoord(a8);if(a4.contains(a7)||ba.contains(a7)){return this}this.hideCalendar();return this},_focusAction:function(a3){this.showCalendar();return this},_keyupAction:function(a3){this.showCalendar();return this},_keydownAction:function(a5){var a3=aN.key.parse(a5),a4=aN.key(9),a6=aN.key(9,false,false,true);if(a3.equals(a4)||a3.equals(a6)){this.hideCalendar()}return this}};aN.ext(ad,aD);aN.fields.dayPoint=function(a3){return new ad(a3)};function G(a3){G.base.call(this,a3);this.spec(aN.fields.specs.email).tooltip(aN.tooltip().message("Enter a valid email address."))}G.prototype={$read:function(){return this.dom().value},$write:function(a3){this.dom().value=a3}};aN.ext(G,aD);aN.fields.email=function(a3){return new G(a3)};function R(a3){R.base.call(this,a3);this.tooltip(aN.tooltip().message("Invalid"))}aN.ext(R,aD);aN.fields.field=function(a3){return new R(a3)};function z(a3){z.base.call(this,a3);this.spec(aN.fields.specs.currency).tooltip(aN.tooltip().message("Enter a valid money amount."));aN.dom(this.dom()).onblur(function(){this.value(this.value())},this)}z.prototype={$read:function(){var a3=this.dom().value;return(aN.money.canParse(a3))?aN.money.parse(a3).value():a3},$write:function(a3){this.dom().value=aN.money.tryParse(a3)||a3}};aN.ext(z,aD);aN.fields.money=function(a3){return new z(a3)};function E(a3){E.base.call(this,a3);this.spec(aN.fields.specs.phone).tooltip(aN.tooltip().message("Enter a valid phone number including area code."));aN.dom(this.dom()).onblur(function(){this.value(this.value())},this)}E.prototype={$read:function(){return this.dom().value.replace(/[^\d]/g,"")},$write:function(a3){this.dom().value=(function(a6,a8){var a5=a6.replace(/[^\d]/g,"").split(/\B/),a7=0,a4=a5.length,a9=(a4<11)?a8.replace(/^#\s/,""):a8;while(a7<a4){a9=a9.replace("#",a5[a7]);a7++}return(/#/.test(a9))?a3:a9})(a3,"# (###) ###-####")}};aN.ext(E,aD);aN.fields.phone=function(a4,a3){return new E(a4,a3)};function O(a3){O.base.call(this,a3);this.tooltip(aN.tooltip().message("Invalid"))}aN.ext(O,aT);aN.fields.select=function(a3){return new O(a3)};function w(){}w.prototype={highlight:function(a6,a4){var a3=a6.getRangeAt(0);try{document.designMode="on";a6.removeAllRanges();a6.addRange(a3);if(!document.execCommand("HiliteColor",false,a4)){document.execCommand("BackColor",false,a4)}document.designMode="off"}catch(a7){try{a3=document.selection.createRange();a3.execCommand("BackColor",false,a4)}catch(a5){}}},clear:function(){}};aN.highlighter=function(){return new w()};function k(){this._onKeyPressed=aN.observer();k.base.call(this,aN.create({div:{"class":"ku-keyboard"}}))}k.prototype={addKey:function(a3){aN.onScreenKey(a3).addClass(aN.str.format("ku-keyboard-key ku-key-{0}",a3)).onPress(this._onKeyPressed.notify,this._onKeyPressed).appendTo(this.dom());return this},onKeyPressed:function(a4,a3){this._onKeyPressed.add(a4,a3);return this}};aN.ext(k,aN.dom.Class);aN.onScreenKeyboard=function(){return new k()};function ar(a3){if(!aN.isNumber(a3)){aN.exception("arg",aN.str.format("Invalid argument code:{0}",a3))}this._value=aN.key(a3);this._onPress=aN.observer();this._onRelease=aN.observer();ar.base.call(this,aN.create({button:{"class":"ku-keyboard-key"},content:this._value.toString()}));this.onmousedown(function(){this._onPress.notify(this._value)},this).ontouchstart(function(){this._onPress.notify(this._value)},this).onmouseup(function(){this._onRelease.notify(this._value)},this).ontouchend(function(){this._onRelease.notify(this._value)},this)}ar.prototype={onPress:function(a4,a3){this._onPress.add(a4,a3);return this},onRelease:function(a4,a3){this._onRelease.add(a4,a3);return this}};aN.ext(ar,aN.dom.Class);aN.onScreenKey=function(a3){return new ar(a3)};function L(a3){L.base.call(this,a3)}L.prototype={value:function(){},ratio:function(){return this.minValue()/this.maxValue()},minValue:function(a3){this.get("minValue",a3)},maxValue:function(a3){this.get("maxValue",a3)}};aN.ext(L,aN.dom.Class);function av(){}av.prototype={};function A(a4){var a3=a4||aN.create({div:{"class":"ku-sprite"}});A.base.call(this,a3);this.to().dragOn().force(0.4).mu(0.8);this._isTo}A.prototype={force:function(a3){return this.property("force",a3)},mu:function(a3){return this.property("mu",a3)},algorithm:function(a3){return this.set("algorithm",a3)},to:function(){this._isTo=true;return this.algorithm(aN.anime.algorithms.jump())},spring:function(){this._isTo=false;return this.algorithm(aN.anime.algorithms.spring(this._force,this._mu))},ease:function(){this._isTo=false;return this.algorithm(aN.anime.algorithms.ease.linear(this._force,this._mu))},fitTo:function(a5,a4,a3){return this._act("fitter",a5,a4,a3)},sizeTo:function(a5,a4,a3){return this._act("sizer",a5,a4,a3)},pinTo:function(a5,a4,a3){return this._act("pinner",a5,a4,a3)},scrollTo:function(a5,a4,a3){return this._act("scroller",a5,a4,a3)},fadeTo:function(a3,a5,a4){return this._act("fader",a3,a5,a4)},growTo:function(a5,a4,a3){return this.sizeTo(a5).pinTo(this.boundedOffset().subtract(a5.subtract(this.outerDims()).half()),a4,a3)},_act:function(a9,a8,a7,a6){var a4=aN[a9](this.dom()).algorithm(this._algorithm),a3="_"+a9,a5=this[a3];if(aN.exists(a5)){a5.stop()}if(aN.exists(a7)){a4.onEnd(a7,a6)}if(this._isTo){this[a3]=a4.to(a8)}else{this[a3]=a4.moveTo(a8)}return this},tween:function(a4,a3){this._styler=aN.styler(this.dom(),a4).algorithm(this._algorithm).moveTo(a3);return this},clear:function(){if(aN.exists(this._fader)){this._fader.stop()}if(aN.exists(this._sizer)){this._sizer.stop()}if(aN.exists(this._fitter)){this._fitter.stop()}if(aN.exists(this._pinner)){this._pinner.stop()}if(aN.exists(this._scroller)){this._scroller.stop()}if(aN.exists(this._styler)){this._styler.stop()}return this},dragHandle:function(a3){return this.property("dragHandle",a3)},dragType:function(a3){return this.set("dragType",a3)},dragOffset:function(a3){this._dnd.dragOffset(a3);return this},dragger:function(){this._dnd.dragger();return this},sizer:function(){this._dnd.sizer();return this},scroller:function(){this._dnd.scroller();return this},dragOn:function(){this._dnd=aN.dnd(this.dom()).onGrab(this.clear,this);return this},dragOff:function(){this._dnd.destroy();return this},onGrab:function(a4,a3,a5){this._dnd.onGrab(a4,a3,a5);return this},onDrag:function(a4,a3,a5){this._dnd.onDrag(a4,a3,a5);return this},onDrop:function(a4,a3,a5){this._dnd.onDrop(a4,a3,a5);return this},bearingUp:function(){return this._dnd.bearingUp()},bearingDown:function(){return this._dnd.bearingDown()},bearingLeft:function(){return this._dnd.bearingLeft()},bearingRight:function(){return this._dnd.bearingRight()},grab:function(a3){this._dnd.grab(a3);return this},drag:function(a3){this._dnd.drag(a3);return this},drop:function(a3){this._dnd.drop(a3);return this},constrainX:function(){this._dnd.constrainX();return this},unconstrainX:function(){this._dnd.unconstrainX();return this},constrainY:function(){this._dnd.constrainY();return this},unconstrainY:function(){this._dnd.unconstrainY();return this}};aN.ext(A,aN.dom.Class);aN.sprite=function(a3){return new A(a3)};aN.sprite.Class=A;var aV=function(a3,a4){this.$offset=0;this.$multiplier=a4;this._tooltip=a3;this.overlap(0)};aV.prototype={$above:function(a3,a5,a4){return},$below:function(a3,a5,a4){return},$leftOf:function(a3,a5,a4){return},$rightOf:function(a3,a5,a4){return},overlap:function(a3){return this.set("overlap",a3)},above:function(a7){var a5=this._tooltip,a3=a5.context(a7).context(),a6=a5.pointer(),a4=a5.tooltip();this.$offset=this._overlap;this.$above(a3,a6,a4);return this},below:function(a7){var a5=this._tooltip,a3=a5.context(a7).context(),a6=a5.pointer(),a4=a5.tooltip();this.$offset=this._overlap;this.$below(a3,a6,a4);return this},leftOf:function(a7){var a5=this._tooltip,a3=a5.context(a7).context(),a6=a5.pointer(),a4=a5.tooltip();this.$offset=this._overlap;this.$leftOf(a3,a6,a4);return this},rightOf:function(a7){var a5=this._tooltip,a3=a5.context(a7).context(),a6=a5.pointer(),a4=a5.tooltip();this.$offset=this._overlap;this.$rightOf(a3,a6,a4);return this}};aN.ext(aV,aN.Class);var a1=function(a3,a4){a1.base.call(this,a3,0.5)};a1.prototype={$above:function(a3,a5,a4){a5.pinTo(a3.offset().subtract(a5.outerHeight()).add(aN.coord(a3.outerDims().subtract(a5.outerDims()).x()*this.$multiplier,0)));a4.pinTo(a5.offset().subtract(a4.outerHeight()).add(aN.coord(0,this.$offset)).add(aN.coord(a5.outerDims().subtract(a4.outerDims()).x()*this.$multiplier,0)));a5.fadeTo(100);a4.fadeTo(100);return this},$below:function(a3,a5,a4){a5.pinTo(a3.offset().add(a3.outerHeight()).add(aN.coord(a3.outerDims().subtract(a5.outerDims()).x()*this.$multiplier,0)));a4.pinTo(a5.offset().add(a5.outerHeight()).subtract(aN.coord(0,this.$offset)).add(aN.coord(a5.outerDims().subtract(a4.outerDims()).x()*this.$multiplier,0)));a5.fadeTo(100);a4.fadeTo(100);return this},$leftOf:function(a3,a5,a4){a5.pinTo(a3.offset().subtract(a5.outerWidth()).add(aN.coord(0,a3.outerDims().subtract(a5.outerDims()).y()*this.$multiplier)));a4.pinTo(a5.offset().subtract(a4.outerWidth()).add(aN.coord(this.$offset,0)).add(aN.coord(0,a5.outerDims().subtract(a4.outerDims()).y()*this.$multiplier)));a5.fadeTo(100);a4.fadeTo(100);return this},$rightOf:function(a3,a5,a4){a5.pinTo(a3.offset().add(a3.outerWidth()).add(aN.coord(0,a3.outerDims().subtract(a5.outerDims()).y()*this.$multiplier)));a4.pinTo(a5.offset().add(a5.outerWidth()).subtract(aN.coord(this.$offset,0)).add(aN.coord(0,a5.outerDims().subtract(a4.outerDims()).y()*this.$multiplier)));a5.fadeTo(100);a4.fadeTo(100);return this}};aN.ext(a1,aV);var aJ=function(a3,a4){aJ.base.call(this,a3,0)};aJ.prototype={$above:function(a3,a5,a4){a5.pinTo(a3.offset().subtract(a5.outerHeight()).add(aN.coord(this.$offset,0)).add(aN.coord(a3.outerDims().subtract(a5.outerDims()).x()*this.$multiplier,0)));a4.pinTo(a5.offset().subtract(a4.outerHeight()).add(aN.coord(-this.$offset,this.$offset)).add(aN.coord(a5.outerDims().subtract(a4.outerDims()).x()*this.$multiplier,0)));a5.fadeTo(100);a4.fadeTo(100);return this},$below:function(a3,a5,a4){a5.pinTo(a3.offset().add(a3.outerHeight()).add(aN.coord(this.$offset,0)).add(aN.coord(a3.outerDims().subtract(a5.outerDims()).x()*this.$multiplier,0)));a4.pinTo(a5.offset().add(a5.outerHeight()).subtract(aN.coord(this.$offset,this.$offset)).add(aN.coord(a5.outerDims().subtract(a4.outerDims()).x()*this.$multiplier,0)));a5.fadeTo(100);a4.fadeTo(100);return this},$leftOf:function(a3,a5,a4){a5.pinTo(a3.offset().subtract(a5.outerWidth()).add(aN.coord(0,this.$offset)).add(aN.coord(0,a3.outerDims().subtract(a5.outerDims()).y()*this.$multiplier)));a4.pinTo(a5.offset().subtract(a4.outerWidth()).add(aN.coord(this.$offset,-this.$offset)).add(aN.coord(0,a5.outerDims().subtract(a4.outerDims()).y()*this.$multiplier)));a5.fadeTo(100);a4.fadeTo(100);return this},$rightOf:function(a3,a5,a4){a5.pinTo(a3.offset().add(a3.outerWidth()).add(aN.coord(0,this.$offset)).add(aN.coord(0,a3.outerDims().subtract(a5.outerDims()).y()*this.$multiplier)));a4.pinTo(a5.offset().add(a5.outerWidth()).subtract(aN.coord(this.$offset,this.$offset)).add(aN.coord(0,a5.outerDims().subtract(a4.outerDims()).y()*this.$multiplier)));a5.fadeTo(100);a4.fadeTo(100);return this}};aN.ext(aJ,aV);var at=function(a3,a4){at.base.call(this,a3,1)};at.prototype={$above:function(a3,a5,a4){a5.pinTo(a3.offset().subtract(a5.outerHeight()).add(aN.coord(-this.$offset,0)).add(aN.coord(a3.outerDims().subtract(a5.outerDims()).x()*this.$multiplier,0)));a4.pinTo(a5.offset().subtract(a4.outerHeight()).add(aN.coord(this.$offset,this.$offset)).add(aN.coord(a5.outerDims().subtract(a4.outerDims()).x()*this.$multiplier,0)));a5.fadeTo(100);a4.fadeTo(100);return this},$below:function(a3,a5,a4){a5.pinTo(a3.offset().add(a3.outerHeight()).add(aN.coord(-this.$offset,0)).add(aN.coord(a3.outerDims().subtract(a5.outerDims()).x()*this.$multiplier,0)));a4.pinTo(a5.offset().add(a5.outerHeight()).add(aN.coord(this.$offset,-this.$offset)).add(aN.coord(a5.outerDims().subtract(a4.outerDims()).x()*this.$multiplier,0)));a5.fadeTo(100);a4.fadeTo(100);return this},$leftOf:function(a3,a5,a4){a5.pinTo(a3.offset().subtract(a5.outerWidth()).add(aN.coord(0,-this.$offset)).add(aN.coord(0,a3.outerDims().subtract(a5.outerDims()).y()*this.$multiplier)));a4.pinTo(a5.offset().subtract(a4.outerWidth()).add(aN.coord(this.$offset,this.$offset)).add(aN.coord(0,a5.outerDims().subtract(a4.outerDims()).y()*this.$multiplier)));a5.fadeTo(100);a4.fadeTo(100);return this},$rightOf:function(a3,a5,a4){a5.pinTo(a3.offset().add(a3.outerWidth()).add(aN.coord(0,-this.$offset)).add(aN.coord(0,a3.outerDims().subtract(a5.outerDims()).y()*this.$multiplier)));a4.pinTo(a5.offset().add(a5.outerWidth()).add(aN.coord(-this.$offset,this.$offset)).add(aN.coord(0,a5.outerDims().subtract(a4.outerDims()).y()*this.$multiplier)));a5.fadeTo(100);a4.fadeTo(100);return this}};aN.ext(at,aV);var J=function(){J.base.call(this);this.pointer(aN.sprite(aN.create({div:{"class":"ku-tooltip-pointer"}})).hide().dragOff().to()).tooltip(aN.sprite(aN.create({div:{"class":"ku-tooltip"}})).hide().dragOff().to()).leftJustify();this._id=aN.uid("tip");this._onShow=aN.observer();this._onHide=aN.observer()};J.prototype={calibrate:function(a3){return this.property("calibrate",a3)},pointer:function(a3){return this.property("pointer",a3)},tooltip:function(a3){return this.property("tooltip",a3)},strategy:function(a3){return this.property("strategy",a3)},message:function(a3){return this.property("message",a3)},context:function(a4){var a3=(aN.exists(a4))?aN.dom(a4):a4;return this.property("context",a3)},center:function(){return this.strategy(new a1(this))},leftJustify:function(){return this.strategy(new aJ(this))},rightJustify:function(){return this.strategy(new at(this))},onShow:function(a4,a3){this._onShow.add(a4,a3);return this},onHide:function(a4,a3){this._onHide.add(a4,a3);return this},show:function(a5){var a3=a5||this._message,a4=a3||"";this._pointer.fadeTo(0).appendTo(document.body).show();this._tooltip.fadeTo(0).appendTo(document.body).html("").content(a4).show();this._onShow.notify();return this},hide:function(){this._pointer.hide().detach();this._tooltip.hide().detach();this._onHide.notify();return this},at:function(a8,a4){var a6=aN.window(),a7=aN.dom(a8),a3=aN.coord.zero(),a9=a6.dims(),a5=a7.offset();b=a5.add(a7.outerDims()),C=this._tooltip.outerDims(),bPlusC=b.add(C),aLessC=a5.subtract(C),rightOf=!bPlusC.isRightOf(a9),below=!bPlusC.isBelow(a9),leftOf=!aLessC.isLeftOf(a3),above=!aLessC.isAbove(a3),prefer={rightOf:rightOf,below:below,leftOf:leftOf,above:above};if(prefer[a4[0]]){return this[a4[0]](a8)}if(prefer[a4[1]]){return this[a4[1]](a8)}if(prefer[a4[2]]){return this[a4[2]](a8)}if(prefer[a4[3]]){return this[a4[3]](a8)}return this.rightOf(a8)},above:function(a3){return this._locate(a3,"bottom","above")},below:function(a3){return this._locate(a3,"top","below")},leftOf:function(a3){return this._locate(a3,"right","leftOf")},rightOf:function(a3){return this._locate(a3,"left","rightOf")},_locate:function(a5,a4,a3){this.strategy().overlap(aZ(this,a4))[a3](a5);aW(this,a3);this._pointer.fadeTo(100);this._tooltip.fadeTo(100);return this}};aN.ext(J,aN.Class);aN.tooltip=function(){return new J()};function aZ(a5,a4){var a3=a5.tooltip().style(aN.str.format("border-{0}-width",a4));return aN.ku.style.toNumber(a3)}function aW(a5,a3){var a6="ku-{0}",a4=["above","below","leftOf","rightOf"],a7=a5.pointer();for(var a8 in a4){a7.removeClass(aN.str.format(a6,a4[a8]))}a7.addClass(aN.str.format(a6,a3))}function aE(a3){this._target=aN.sprite(a3).dragOff();this._helper=aN.sprite(aN.create({div:{"class":"ku-droptarget-helper",style:"position:absolute;"},content:"helper"})).fadeTo(30).hide();this._observer=aN.observer()}aE.prototype={add:function(a5,a4,a3){this._observer.add(aN.uid("drop"),evtId)},remove:function(a3){},_hits:function(a6){var a3=aN.mouse().documentCoord(a6),a4=this.tl,a5=this.br;return a3.isRightOf(a4)&&a3.isBelow(a4)&&a3.isLeftOf(a5)&&a3.isAbove(a5)}};aN.ext(aE,aN.dom.Class);aN.droptarget=function(a3){return new aE(a3)};function T(a3,a4){T.base.call(this);var a5=aN.dom(a3).addClass("ku-file-tab").onclick(this.invoke,this),a6=aN.dom(a4).addClass("ku-file-content"),a7="ku-file-active";this.onActive(function(){a5.addClass(a7);a6.addClass(a7)}).onInactive(function(){a5.removeClass(a7);a6.removeClass(a7)})}T.prototype={};aN.ext(T,aN.toggle.Class);function x(a3){x.base.call(this);var a4=aN.dom(a3).addClass("ku-file-content"),a5="ku-file-active";this.onActive(function(){a4.addClass(a5)}).onInactive(function(){a4.removeClass(a5)})}x.prototype={};aN.ext(x,aN.toggle.Class);aN.file=function(a3,a4){return(aN.exists(a3))?new T(a3,a4):new x(a4)};function ai(){ai.base.call(this);this.mutuallyExclusive()}ai.prototype={};aN.ext(ai,aN.toggleset.Class);aN.fileCabinet=function(){return new ai()};aN.mouseLogger=function(){var a3=aN.create({div:{style:{position:"absolute"}}});return{on:function(){document.body.appendChild(a3);this.__con=new aN.sprite(a3);this.__evt=aN.evt.add(document,"mousemove",function(a8){var a6=aN.str.build("Document:&nbsp;{0}<br/>Page:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{1}","<br/>Screen:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{2}","<br/>Client:&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{3}","<br/>Target:&nbsp;{4}"),a9=aN.mouse().documentCoord(a8),a7=aN.mouse().pageCoord(a8),a5=aN.mouse().screenCoord(a8),ba=aN.mouse().clientCoord(a8),a4=aN.mouse().target(a8);this.__con.pinTo(aN.mouse().documentCoord(a8).add(aN.coord(10,10))).html(aN.str.format(a6,a9.toString(),a7.toString(),a5.toString(),ba.toString(),a4))},this)},off:function(){document.body.removeChild(a3);var a4=this.__evt,a5=this.__con;if(aN.exists(a4)){aN.evt.remove(a4)}if(aN.exists(a5)){a5.destroy()}}}};function N(a3){N.base.call(this,a3);this._velocityId=aN.uid("projectile");this._flyId=aN.uid("projectile");this.gravity(aN.vector(0,0.5)).friction(0.98).velocity(aN.vector.zero()).lowerBound(aN.coord.zero()).upperBound(aN.window.dims()).lastCoord(this.offset()).onDrop(function(){aB(this,this._velocityId,this._flyId)},this).onGrab(function(){this.velocity(aN.vector.zero());aN.timeline().remove(this._flyId).add(function(){q(this)},this,this._velocityId)},this)}N.prototype={gravity:function(a3){return this.property("gravity",a3)},friction:function(a3){return this.property("friction",a3)},velocity:function(a3){return this.property("velocity",a3)},lowerBound:function(a3){return this.property("lowerBound",a3)},upperBound:function(a3){return this.property("upperBound",a3)},lastCoord:function(a3){return this.property("lastCoord",a3)},stop:function(){aN.timeline().remove(this._velocityId).remove(this._flyId);return this}};aN.ext(N,aN.sprite.Class);aN.projectile=function(a3){return new N(a3)};function q(a3){a3.velocity(a3.offset().distanceFrom(a3.lastCoord()));a3.lastCoord(a3.offset())}function aB(a4,a3,a5){aN.timeline().remove(a3).add(function(){aQ(this)},a4,a5)}function aQ(bh){var be=bh.velocity(),a4=bh.boundedOffset(),a9=bh.outerDims(),a3=a4.add(a9),a8=bh.lowerBound(),bd=bh.upperBound(),bg=(a4.isAbove(a8)&&(be.y()<=0))||(a3.isBelow(bd)&&(be.y()>=0)),bf=(a4.isLeftOf(a8)&&(be.x()<=0))||(a3.isRightOf(bd)&&(be.x()>=0)),a5=(bg||bf)?0.8:1,a7=bg?aN.vector(0,1):bf?aN.vector(1,0):aN.vector.zero(),bc=be.add(bh.gravity()).scale(bh.friction()).scale(a5).reflect(a7),ba=bc.magnatude()>1||a4.isAbove(bd.add(a9).add(aN.coord(0,10))),a6=ba?bc:aN.vector.zero(),bb=ba?a4.add(a6):aN.coord(a4.x(),bd.subtract(a9).y());bh.velocity(a6).pinTo(bb)}function I(){var a4=aN.create({div:{"class":"ku-responsebox"}}),a3=aN.uid("responsebox");I.base.call(this,a4);this._contentDom=aN.sprite(aN.create({div:{"class":"ku-responsebox-content"}})).fadeTo(0).dragOff().force(0.4).ease();this._onOpen=aN.observer();this._onClose=aN.observer();this._onCalibrate=aN.observer();this._onWindowResize=aN.observer();this._onContentChanged=aN.observer();this._closeSize=aN.coord.zero();this._isOpen=false;this.force(0.8).mu(0.5).appendChild(this._contentDom.dom()).positionStrategy(function(){return aN.window().scrollCenter()}).bounds(document.body).to();aN.window().onresize(function(){this._onWindowResize.notify()},this,a3)}I.prototype={content:function(a3){this._contentDom.content(a3);this._onContentChanged.notify();return this},disableWindow:function(){aN.window().disable();return this},enableWindow:function(){aN.window().enable();return this},positionStrategy:function(a3){return this.property("positionStrategy",a3)},openSize:function(a3){return this.property("openSize",a3)},bounds:function(a3){return this.property("bounds",a3)},onOpen:function(a4,a3,a5){this._onOpen.add(a4,a3,a5);return this},onClose:function(a4,a3,a5){this._onClose.add(a4,a3,a5);return this},onCalibrate:function(a4,a3,a5){this._onCalibrate.add(a4,a3,a5);return this},onWindowResize:function(a4,a3,a5){this._onWindowResize.add(a4,a3,a5);return this},onContentChanged:function(a4,a3,a5){this._onContentChanged.add(a4,a3,a5);return this},removeListener:function(a3){this._onOpen.remove(a3);this._onClose.remove(a3);this._onCalibrate.remove(a3);this._onContentChanged.remove(a3)},calibrate:function(){return this.pinTo(aO(this),function(){this._onCalibrate.notify()},this)},recalibrate:function(){this.clear().ease();var a3=this.openSize()||this._contentDom.outerDims();return this.growTo(a3,this.calibrate,this)},transition:function(a3){this._contentDom.clear().fadeTo(0,function(){this.clear().ease().content(a3);var a4=this.openSize()||this._contentDom.outerDims();this.growTo(a4,function(){this.pinTo(aO(this),function(){this._contentDom.fadeTo(100,function(){this.redraw()},this)},this)},this)},this);return this},open:function(a4){this.clear().to().fadeTo(100,function(){this._contentDom.fadeTo(0)},this).appendTo(this.bounds());this._onOpen.notify();var a3=this;if(a4){setTimeout(function(){aU(a3)},a4)}else{aU(a3)}},close:function(){this._contentDom.ease().fadeTo(0,function(){this.ease().growTo(this._closeSize,function(){this.detach();this._onClose.notify()},this)},this);return this}};aN.ext(I,aN.sprite.Class);aN.responsebox=function(){return new I()};function aO(a4){var a7=a4._positionStrategy().subtract(a4.outerDims().half()),a6=aN.window().scrollOffset(),a3=(a7.isLeftOf(a6))?a6.x():a7.x(),a5=(a7.isAbove(a6))?a6.y():a7.y();return aN.coord(a3,a5)}function aU(a5){var a4=a5._contentDom,a3=a5.openSize()||a4.outerDims();a5.growTo(a3,function(){this.pinTo(aO(this),function(){a4.fadeTo(100)},a5)},a5)}function L(a4){V.base.call(this,a4);var a3=aN.create({div:{"class":"ku-scrubber-scrub"}}),a5=aN.create({div:{"class":"ku-scrubber-scrubline"}});this._scrubber=aN.sprite(a3);this._scrubline=aN.sprite(a5).appendChild(a3).dragOff()}L.prototype={scrollPanel:function(a3){return this.property("scrollPanel",a3)},onScrub:function(a4,a3,a5){this._scrubber.onDrag(a4,a3,a5)}};aN.ext(L,aN.sprite.Class);aN.scrubber=function(a3){return new L(a3)};function ay(a3){ay.base.call(this,a3);var a4=aN.create({div:{}});this._content=aN.sprite(a4).addClass("ku-scrollPanel-content").onGrab(function(){var a5=this._content;a5.dragOffset(a5.layoutDims())},this).onDrop(function(){var a5=this._content;this.scrollTo(a5.boundedOffset().add(a5.layoutDims()))},this);this.appendChild(a4).addClass("ku-scrollPanel").dragOff()}ay.prototype={min:function(){return aN.coord.zero()},max:function(){return this.get("max")},content:function(a3){var a5,a4=this._content;if(aN.isString(a3)){a5=a4.html(a3).pinTo(aN.coord.zero())}else{a5=a4.clear().appendChild(a3).pinTo(aN.coord.zero())}this._max=aF(this);return a5},constrainX:function(){this._content.constrainX();return this},unconstrainX:function(){this._content.unconstrainX();return this},constrainY:function(){this._content.constrainY();return this},unconstrainY:function(){this._content.unconstrainY();return this},scrollTo:function(a7){if(!aN.exists(a7)){return this}var a5=this.min(),a4=this.max()||a5,a3=a7.x(),a6=a7.y();if(a7.isRightOf(a5)){a3=a5.x()}if(a7.isLeftOf(a4)){a3=a4.x()}if(a7.isBelow(a5)){a6=a5.y()}if(a7.isAbove(a4)){a6=a4.y()}this._content.to().pinTo(aN.coord(a3,a6));return this},scroller:function(a3){this.set("scroller",a3.scrollPanel(this))},displayScroller:function(){},hideScroller:function(){}};aN.ext(ay,aN.sprite.Class);aN.scrollPanel=function(a3){return new ay(a3)};function aF(a7){var a6=a7._content.outerDims().subtract(a7.innerDims()),a4=aN.coord.zero(),a3=a6.isLeftOf(a4)?a4.x():a6.x(),a5=a6.isAbove(a4)?a4.y():a6.y();return a7.min().subtract(aN.coord(a3,a5))}})($);(function(h){if(!h){h={}}function g(o){g.base.call(this,o);this.dragOff().value(0)}g.prototype={value:function(o){return this.property("value",o)},display:function(o){o.display(this);return this}};h.ext(g,h.sprite.Class);h.chart=function(o){return new g(o)};function a(o){a.base.call(this,o)}a.prototype={$draw:function(o){return},$clear:function(){return},display:function(o){o.to().fadeTo(0,function(){h.clearNode(o.dom());this.appendTo(o.dom());o.fadeTo(100,function(){this.$draw(o)},this)},this)}};h.ext(a,h.dom.Class);h.abstractPerspective=function(){return new a()};function e(){e.base.call(this,h.create({canvas:{}}));this._context=this.dom().getContext("2d")}e.prototype={$draw:function(z){var A=this,q=this._context,G=z.value(),u=this.dom(),o=-0.5*Math.PI,r=this._skillValues[z.value()],F=z.outerDims(),E=F.x(),B=F.y(),v=E/2,D=q.createRadialGradient(v/2,v/2,2,v,v,v);u.width=E;u.height=B;D.addColorStop(0,"#afa");D.addColorStop(0.7,"#3a3");D.addColorStop(1,"#0a0");function w(x){q.clearRect(0,0,E,B);q.beginPath();q.strokeStyle="#ccc";q.arc(v,v,v,0,2*Math.PI);q.closePath();q.stroke();q.beginPath();q.fillStyle=D;q.arc(v,v,v,o,x);q.lineTo(v,v);q.fill();q.closePath()}h.tween(w,o,r,h.anime.algorithms.ease.linear(0.3)).onEnd(function(){w(r)}).start();return this},_skillValues:[-0.5*Math.PI,0,0.5*Math.PI,Math.PI,1.5*Math.PI]};h.ext(e,a);h.circlePerspective=function(){return new e()};function k(){k.base.call(this,h.create({input:{}}))}k.prototype={$draw:function(o){this.onblur(function(){var q=parseInt(this.dom().value),r=(isNaN(q)||q<0||q>4)?0:q;o.value(r).display(h.circlePerspective())},this).appendTo(o).dom().select()}};h.ext(k,a);h.inputPerspective=function(o){return new k(o)};function d(){d.base.call(this,h.create({canvas:{}}));this._context=this.dom().getContext("2d")}d.prototype={$draw:function(u){var r=this._context,v=u.value(),z=u.outerDims(),w=this.dom(),o=z.x(),A=z.y(),q;switch(v){case 1:q="#cfc";break;case 2:q="#8c8";break;case 3:q="#6b6";break;case 4:q="#080";break;default:q="#fff";break}w.width=o;w.height=A;r.clearRect(0,0,o,A);r.beginPath();r.strokeStyle="#ccc";r.rect(0,0,o,A);r.closePath();r.stroke();r.beginPath();r.fillStyle=q;r.rect(0,0,o,A);r.closePath();r.fill()}};h.ext(d,a);h.rectanglePerspective=function(){return new d()}})($);(function(a){if(!a){a={}}function d(e){d.base.call(this,e);this._onPlayheadChanged=a.observer();this._addEvent("timeupdate",function(){this._onPlayheadChanged.notify(this)},this,a.uid())}d.prototype={play:function(e){this._dom.play();return this},pause:function(){this._dom.pause();return this},load:function(){this._dom.load();return this},duration:function(){return this._dom.duration},remaining:function(){return this.duration()-this.playhead()},playhead:function(e){if(!a.exists(e)){return this._dom.currentTime}this._dom.currentTime=e;return this},onPlayheadChanged:function(e,g){this._onPlayheadChanged.add(e,g);return this}};a.ext(d,a.sprite.Class);a.media=function(e){return new d(e)}})($);