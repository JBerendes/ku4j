//kodmunki utilities
(function(i){if(!i){i={}}i.DomClass=function(F){i.DomClass.base.call(this);this.dom(i.refcheck(F,i.str.format("$.DomClass requires valid DOM node.")))};i.DomClass.prototype={dom:function(F){return this.property("dom",F)}};i.ext(i.DomClass,i.Class);var b=function(){};b.prototype={};i.ext(b,i.Class);function E(){E.base.call(this);this._processId=i.uid("svc");this._onSuccess=i.observer();this._onError=i.observer();this._onComplete=i.observer();this._lock=i.lock();this._isLocal=false;this.GET().text().xhr().async().unlock()}E.prototype={processId:function(){return this.get("processId")},verb:function(F){return this.property("verb",F)},callType:function(F){return this.property("callType",F)},responseType:function(F){return this.property("responseType",F)},uri:function(F){return this.property("uri",F)},maxAttempts:function(F){return this.property("maxAttempts",F)},isLocal:function(F){return this.property("isLocal",F)},strategy:function(F){if(i.exists(F)){F.context(this)}return this.property("strategy",F)},isAsync:function(){return/ASYNC/i.test(this.callType())},isPost:function(){return/POST/i.test(this.verb())},isLocked:function(){return this._lock.isLocked()},isBusy:function(){return this._isBusy},onSuccess:function(G,F,H){this._onSuccess.add(G,F,H);return this},onError:function(G,F,H){this._onError.add(G,F,H);return this},onComplete:function(G,F,H){this._onComplete.add(G,F,H);return this},removeListener:function(F){this._onSuccess.add(F);this._onError.add(F);this._onComplete.add(F);return this},clearListeners:function(){this._onSuccess.clear();this._onError.clear();this._onComplete.clear();return this},OPTIONS:function(){return this.verb("OPTIONS")},GET:function(){return this.verb("GET")},HEAD:function(){return this.verb("HEAD")},POST:function(){return this.verb("POST")},PUT:function(){return this.verb("PUT")},DELETE:function(){return this.verb("DELETE")},TRACE:function(){return this.verb("TRACE")},CONNECT:function(){return this.verb("CONNECT")},xhr:function(){return this.strategy(new k())},xss:function(){return this.strategy(new e())},sync:function(){return this.callType("sync")},async:function(){return this.callType("async")},text:function(){return this.responseType("responseText")},xml:function(){return this.responseType("responseXML")},success:function(F){this._onSuccess.notify(F,this._processId);return this},error:function(F){this._onError.notify(F,this._processId);return this},complete:function(F){this._onComplete.notify(F,this._processId);this._isBusy=false;return this},lock:function(){this._lock.lock();return this},unlock:function(){this._lock.unlock();return this},abort:function(){if(!this._isBusy){return this}this.strategy().abort();return this},call:function(F){if(this.isLocked()){return this}this._isBusy=true;this.strategy().call(F);return this}};i.ext(E,i.Class);i.service=function(){return new E()};i.service.noCache=function(G){var F=i.dto({noCache:i.uid()});if(!i.exists(G)){return F}return G.merge(F)};function k(){k.base.call(this);this._isOk=function(F){return/[23]\d{2}/.test(F)||this.context().isLocal()};this._isAborted=function(F){return !/\d{3}/.test(F)};this._attempts=0}k.prototype={context:function(F){return this.property("context",F)},abort:function(){try{this._xhr.abort()}catch(F){}},call:function(J){this._xhr=n();var G=this.context(),H=G.isPost(),I=this._xhr,F=i.exists(J);format=(H||!F)?"{0}":"{0}?{1}",postParams=(H)?J:null,paramLength=(F)?J.length:0;me=this;if(!i.exists(I)){G.error(new Error("Ajax not supported"))}I.open(G.verb(),i.str.format(format,G.uri(),J),G.isAsync());if(H){I.setRequestHeader("Content-type","application/x-www-form-urlencoded");I.setRequestHeader("Content-length",paramLength);I.setRequestHeader("Connection","close")}I.onreadystatechange=function(){if(I.readyState>3){var L=I[G.responseType()],K=I.status;if(me._isAborted(K)){return}if(me._isOk(K)){G.success(L).complete(L);return}if(me._attempts<G.maxAttempts()){me.call(J);return}G.error(L).complete(L)}};I.send(postParams)}};i.ext(k,i.Class);function n(){return(i.exists(XMLHttpRequest))?new XMLHttpRequest():(i.exists(window.ActiveXObject))?(function(){var F=["MSXML2.Http6.0","MSXML2.Http5.0","MSXML2.Http4.0","MSXML2.Http3.0","MSXML2.Http"];for(var H in F){try{return new ActiveXObject(F[H])}catch(G){}}return null})():null}function e(){k.base.call(this);this._head=document.documentElement.getElementsByTagName("head")[0]}e.prototype={context:function(F){return this.property("context",F)},abort:function(){try{this._head.removeChild(this._script)}catch(F){}},call:function(I){var F=this.context(),K=document.documentElement.getElementsByTagName("head")[0],M="{0}?ku4jXssOnSuccess=kodmunki.{1}&ku4jXssOnError=kodmunki.{2}&ku4jXssOnComplete=kodmunki.{3}{4}",H=F.processId(),O=H+"_success",J=H+"_error",G=H+"_complete",N=(i.exists(I))?"&"+I:"",L=i.str.format(M,F.uri(),O,J,G,N);this._script=i.create({script:{src:L,language:"javascript",type:"text/javascript"}});kodmunki[O]=function(){F.success.apply(F,arguments)};kodmunki[J]=function(){F.error.apply(F,arguments)};kodmunki[G]=function(){F.complete.apply(F,arguments)};this._head.appendChild(this._script)}};i.ext(e,i.Class);var z={css:{addClass:function(H,F){var G=i.ele(H),I=G.className;if(i.ku.css.hasClass(H,F)){return}G.className+=(/^[^\s]/.test(I))?(" "+F):F},hasClass:function(G,F){if(!i.exists(F)){return false}return(new RegExp(F)).test((i.ele(G)).className)},removeClass:function(H,F){var G=i.ele(H),I=G.className;if(!i.ku.css.hasClass(H,F)){return}G.className=i.str.trim(I.replace(new RegExp("(^|\\s)"+F+"(?![\\w\\-])"),""))}},getText:function(G){var F=i.ele(G);return F.textContent||F.innerText},quirks:{setOpacity:function(H,G){var F=G/100;H.style.opacity=F;H.style["-moz-opacity"]=F;H.style["-webkit-opacity"]=F;H.style.filter=i.str.format("alpha(opacity={0})",G)},clearOpacity:function(F){i.ku.style.set(F,{opacity:null,"-moz-opacity":null,"-webkit-opacity":null,filter:null})}},ready:function(G,F){a[a.length]={f:G,b:F||false}},redraw:function(I){var H=i.ele(I)||document.documentElement,G=H.style.display||"";H.style.display="none";var F=H.offsetHeight;H.style.display=G},style:{set:function(L,H,I){var K=i.ele(L);function F(N){return(/\-/.test(N))?N.replace(/\-\w/,N.charAt(N.indexOf("-")+1).toUpperCase()):N}if(i.isString(H)){try{K.style[F(H)]=I}catch(J){}}for(var M in H){var G=F(M);if(/opacity/i.test(G)){i.ku.quirks.setOpacity(L,H[M]);continue}try{K.style[G]=H[M]}catch(J){continue}}},get:function(L,I){var K=i.ele(L);function F(P,N){var M=(/\-/.test(N))?N.replace(/\-\w/,N.charAt(N.indexOf("-")+1).toUpperCase()):N;try{return window.getComputedStyle(P,null).getPropertyValue(N)}catch(O){return(i.exists(P.currentStyle))?P.currentStyle[N]:(i.exists(P.style))?P.style[M]:""}}if(/opacity/i.test(I)){var G=F(K,I);if(i.exists(G)){return parseFloat(G)*100}else{var H=/alpha\(opacity=\d+(\.\d+)?\)/i.exec(K.style.filter);if(!i.exists(H)){return 100}var J=/\d+(\.\d+)?/i.exec(H[0]);if(!i.exists(J)){return 100}return parseFloat(J[0])}}return F(K,I)},toNumber:function(F){return parseFloat(this.stripUnit(F))},stripUnit:function(F){return(i.exists(F)&&i.exists(F.replace))?F.replace(/[^\-\.\d]/g,""):F},getUnit:function(F){return F.match(/[^\-\.\d]{2}/)[0]}},swapDom:function(H,G){var F=i.ele(H);f=i.ele(G);F.parentNode.replaceChild(f,F)}};i.ku=z;i.clearNode=function(G){var F=i.ele(G);if(!F){return}while(F.hasChildNodes()){F.removeChild(F.firstChild)}};i.create=function(M){if(!M){return null}var G=(i.isString(M))?{x:{}}:M,O,K;for(var H in G){if(H=="content"){continue}O=document.createElement(H);attrs=G[H]}for(var H in attrs){var N=attrs[H];if(/class/i.test(H)){i.ku.css.addClass(O,N);continue}if(/style/i.test(H)){i.ku.style.set(O,N);continue}O.setAttribute(H,N)}try{var L=G.content;if(!L){return O}var I=(!L)?1:L.length;if(i.exists(L.nodeName)){O.appendChild(L);return O}if(!i.isArray(L)){O.innerHTML+=L;return O}while(I--){var F=L[I];if(i.isString(F)||!isNaN(F)){O.innerHTML+=F;continue}var G=(F.hasOwnProperty("appendChild"))?F:i.create(F);O.appendChild(G)}}catch(J){}finally{return O}};i.ele=function(F){if(!F){return null}return(i.isEvent(F))?i.evt.ele(F):(i.isString(F))?document.getElementById(F):(i.exists(F.dom))?F.dom:F};var s=function(J,G,I,H,F){this.dom=J;this.evt=G;this.action=I;this.scope=H;this.bubbles=F};i.evt={add:function(G,M,F,N,H){var J=i.refcheck(i.ele(G),i.str.format("argument dom == {0} at $.evt.add",G)),I=M,O=N||J,K=H||false,L=function(){F.apply(O,arguments)};if(i.exists(J.addEventListener)){J.addEventListener(I,L,K)}else{if(i.exists(J.attachEvent)){J.attachEvent("on"+I,L)}else{J["on"+I]=L}}return new s(J,I,L,O,K)},remove:function(I){var K=I.dom,J=I.evt,H=I.scope,F=I.bubbles,G=I.action;if(K.removeEventListener){K.removeEventListener(J,G,F)}else{if(K.detachEvent){K.detachEvent("on"+J,G)}else{K["on"+J]=null}}return this},ele:function(F){try{return(F.srcElement)?F.srcElement:F.target}catch(F){return null}},mute:function(F){if(i.exists(F.preventDefault)){F.preventDefault()}if(i.exists(F.stopPropogation)){F.stopPropogation()}F.returnValue=false;F.cancelBubble=true;return this}};i.findOuterDims=function(G){var F=i.ele(G);return{width:F.offsetWidth,height:F.offsetHeight}},i.findInnerDims=function(G){var F=i.ele(G);return{width:F.clientWidth,height:F.clientHeight}},i.findOffset=function(H){var G=i.ele(H),F=0,I=0;if(!G){return null}do{F+=G.offsetLeft;I+=G.offsetTop}while((function(){try{G=G.offsetParent}catch(J){G=null}return i.exists(G)})());return{left:F,top:I}};i.findBoundedOffset=function(G){var F=i.ele(G);if(!F){return null}return{left:F.offsetLeft,top:F.offsetTop}},i.findScrollDims=function(G){var F=i.ele(G);return{width:F.scrollWidth,height:F.scrollHeight}};i.findScrollOffset=function(H){var G=i.ele(H),F=0,I=0;if(!G){return null}do{F+=G.scrollLeft||0;I+=G.scrollTop||0}while((function(){try{G=G.parentNode}catch(J){G=null}return i.exists(G)})());return{left:F,top:I}};var D=function(G){this._navigator=G;agents={_isIE:"MSIE",_isNetscape:"Netscape",_isFirefox:"Firefox",_isOpera:"Opera",_isSafari:"Safari",_isChrome:"Chrome"};this._isIE=false;this._isNetscape=false;this._isFirefox=false;this._isOpera=false;this._isSafari=false;this._isChrome=false;this._isUnknown=true;this._version="";if(!i.isObject(G)){return}var G=this._navigator,I=G.userAgent;function K(M){return !i.isNullOrEmpty(I)&&(new RegExp(M,"i")).test(I)}function H(Q){try{var N=(new RegExp("Version\\/(\\d+\\.?){1,}","i")).exec(I),O=(new RegExp(Q+"\\/(\\d+\\.?){1,}","i")).exec(I),M=i.exists(N)?N:O;return(new RegExp("(\\d+\\.?){1,}")).exec(M[0])[0]}catch(P){return""}}var L,F,J;for(L in agents){J=agents[L];F=K(J);if(!F){continue}this[L]=F;this._version=H(J);this._isUnknown=false}this._fullVersion=G.appVersion;this._platform=G.platform;this._allInfo=this._fullVersion+this._platform};D.prototype={isIE:function(){return this._isIE},isNetscape:function(){return this._isNetscape},isFirefox:function(){return this._isFirefox},isOpera:function(){return this._isOpera},isSafari:function(){return this._isSafari&&!this._isChrome},isChrome:function(){return this._isChrome},isUnknown:function(){return this._isUnknown},platform:function(){return this._platform},fullVersion:function(){return this._fullVersion},version:function(){return this._version}};var w;i.ku.browser=function(){if(i.exists(w)){return w}w=new D(navigator);return w};i.ku.browser.Class=D;var v=function(F){v.base.call(this,i.ele(F));var G=this.style("display")||"block";this._display=(/none/i.test(G))?"block":G;this._liveEvents=i.hash()};v.prototype={attribute:function(F,G){var H=this.dom();if(i.isUndefined(G)){return H.getAttribute(F)}H.setAttribute(F,G);return this},addClass:function(F){i.ku.css.addClass(this.dom(),F);return this},removeClass:function(F){i.ku.css.removeClass(this.dom(),F);return this},hasClass:function(F){i.ku.css.hasClass(this.dom(),F);return this},style:function(G,F){if(i.isString(G)&&!i.exists(F)){return i.ku.style.get(this.dom(),G)}i.ku.style.set(this.dom(),G,F);return this},value:function(F){if(!i.exists(F)){return this.dom().value}this.dom().value=F;return this},content:function(F){if(!i.exists(F)){return this}if(i.isNumber(F)||i.isString(F)){return this.html(F)}return this.appendChild(F)},cloneNode:function(F){return this._dom.cloneNode(F||true)},html:function(F){if(!i.exists(F)){return this.dom().innerHTML}this.dom().innerHTML=F;return this},text:function(F){if(!i.exists(F)){return i.ku.getText(this.dom())}i.ku.setText(this.dom(),F);return this},prependChild:function(G){var H=this.dom(),F=H.firstChild;if(i.exists(F)){H.insertBefore(G,F)}else{H.appendChild(G)}return this},appendChild:function(F){this.dom().appendChild(F);return this},removeChild:function(F){this.dom().removeChild(F);return this},insertBefore:function(F){F.parentNode.insertBefore(this.dom(),F);return this},insertAfter:function(F){if(i.exists(F.nextSibling)){F.parentNode.insertBefore(this.dom(),F.nextSibling)}else{F.parentNode.appendChild(this.dom())}return this},appendTo:function(F){F.appendChild(this.dom());return this},detach:function(){try{var G=this.dom();G.parentNode.removeChild(G)}catch(F){}finally{return this}},innerDims:function(F){if(!i.exists(F)){return i.coord.parse(i.findInnerDims(this.dom()))}var G=F.toPixel();this.style({width:G.x(),height:G.y()});return this},outerDims:function(G){if(!i.exists(G)){return i.coord.parse(i.findOuterDims(this.dom()))}var F=this.outerDims().subtract(this.innerDims());return this.innerDims(G.subtract(F))},innerWidth:function(F){var G=this.innerDims();if(!i.exists(F)){return i.coord(G.x(),0)}return this.innerDims(i.coord(F,G.y()))},innerHeight:function(F){var G=this.innerDims();if(!i.exists(F)){return i.coord(0,G.y())}return this.innerDims(i.coord(G.x(),F))},outerWidth:function(F){var G=this.outerDims();if(!i.exists(F)){return i.coord(G.x(),0)}return this.outerDims(i.coord(F,G.y()))},outerHeight:function(F){var G=this.outerDims();if(!i.exists(F)){return i.coord(0,G.y())}return this.outerDims(i.coord(G.x(),F))},boundedOffset:function(){return i.coord.parse(i.findBoundedOffset(this.dom()))},layoutDims:function(){var F=this.dom().parentNode;if(!i.exists(F)){return i.coord.zero()}var G=i.dom(F);return G.outerDims().subtract(G.innerDims()).half()},offset:function(){return i.coord.parse(i.findOffset(this.dom()))},center:function(){return this.offset().add(this.outerDims().half())},scrollDims:function(){return i.coord.parse(i.findScrollDims(this.dom()))},scrollOffset:function(){return i.coord.parse(i.findScrollOffset(this.dom()))},clear:function(){i.clearNode(this.dom());return this},redraw:function(){i.ku.redraw(this.dom());return this},swap:function(F){i.ku.swapDom(this.dom,F.dom);return F},show:function(){this.style({display:this._display});return this},hide:function(){this.style({display:"none"});return this},isVisible:function(){var F=this.offset(),G=this.offset().add(this.innerDims());return i.exists(this.dom().parentNode)&&!/NONE|^$/i.test(this.style("display"))&&i.window().scrollOffset().isLeftOf(G)&&i.window().scrollOffset().isAbove(G)&&i.window().scrollDims().isRightOf(F)&&i.window().scrollDims().isBelow(F)},onmouseover:function(F,H,G){return this._addEvent("mouseover",F,H,G)},onmouseout:function(F,H,G){return this._addEvent("mouseout",F,H,G)},onmousedown:function(F,H,G){return this._addEvent("mousedown",F,H,G)},onmouseup:function(F,H,G){return this._addEvent("mouseup",F,H,G)},onmousemove:function(F,H,G){return this._addEvent("mousemove",F,H,G)},onclick:function(F,H,G){return this._addEvent("click",F,H,G)},ondoubleclick:function(F,H,G){return this._addEvent("dblclick",F,H,G)},onkeydown:function(F,H,G){return this._addEvent("keydown",F,H,G)},onkeyup:function(F,H,G){return this._addEvent("keyup",F,H,G)},onkeypress:function(F,H,G){return this._addEvent("keypress",F,H,G)},onblur:function(F,H,G){return this._addEvent("blur",F,H,G)},onchange:function(F,H,G){return this._addEvent("change",F,H,G)},onerror:function(F,H,G){return this._addEvent("error",F,H,G)},onfocus:function(F,H,G){return this._addEvent("focus",F,H,G)},onload:function(F,H,G){return this._addEvent("load",F,H,G)},onresize:function(F,H,G){return this._addEvent("resize",F,H,G)},onscroll:function(F,H,G){return this._addEvent("scroll",F,H,G)},onselect:function(F,H,G){return this._addEvent("select",F,H,G)},onresize:function(F,H,G){return this._addEvent("resize",F,H,G)},onunload:function(F,H,G){return this._addEvent("unload",F,H,G)},onorientationchange:function(F,H,G){return this._addEvent("orientationchange",F,H,G)},ontouchstart:function(F,H,G){return this._addEvent("touchstart",F,H,G)},ontouchend:function(F,H,G){return this._addEvent("touchend",F,H,G)},ontouchmove:function(F,H,G){return this._addEvent("touchmove",F,H,G)},removeEvent:function(G){var F=this._liveEvents.find(G);if(!i.exists(F)){return this}return this._removeEvent(F,G)},clearEvents:function(){this._liveEvents.listValues().each(function(F){this._removeEvent(F)},this);return this},_addEvent:function(H,G,K,J){var F=J||i.uid("evt"),I=this._liveEvents;if(I.containsKey(F)){return this}I.add(F,i.evt.add(this.dom(),H,G,K));return this},_removeEvent:function(F,G){i.evt.remove(F);this._liveEvents.remove(G);return this}};i.ext(v,i.DomClass);i.dom=function(F){return new v(F)};i.dom.Class=v;function h(){h.base.call(this);this._body=i.dom(document.body)}h.prototype={isDisabled:function(){return this.get("disabled")},isPortrait:function(){return this.orientation.isLandscape()},isLandscape:function(){return Math.abs(window.orientation)==90},disable:function(){this._disabled=true;document.body.appendChild(m);return this},enable:function(){if(!this.isDisabled()){return this}document.body.removeChild(m);this._disabled=false;return this},dims:function(){var F=window.innerWidth||document.documentElement.clientWidth,G=window.innerHeight||document.documentElement.clientHeight;return i.coord(F,G)},center:function(){return this.dims().divide(i.coord(2,2))},scrollOffset:function(){var I=document.documentElement,G=document.body,F=Math.max(I.scrollLeft,G.scrollLeft),H=Math.max(I.scrollTop,G.scrollTop);return i.coord(F,H)},scrollDims:function(){var I=document.documentElement,G=document.body,F=Math.max(I.scrollWidth,G.scrollWidth),H=Math.max(I.scrollHeight,G.scrollHeight);return i.coord(F,H)},scrollCenter:function(){return this.center().add(this.scrollOffset())},contains:function(H){var G=this.scrollOffset(),F=this.scrollDims();return !(H.isAbove(G)||H.isLeftOf(G)||H.isRightOf(F)||H.isBelow(F))},redraw:function(){i.ku.redraw(document.body);i.ku.redraw(document.documentElement);return this},onmousedown:function(F,H,G){return this._body.onmousedown(F,H,G)},onmouseup:function(F,H,G){return this._body.onmouseup(F,H,G)},ontouchstart:function(F,H,G){return this._body.ontouchstart(F,H,G)},ontouchend:function(F,H,G){return this._body.ontouchend(F,H,G)},onclick:function(F,H,G){return this._body.onclick(F,H,G)},ondoubleclick:function(F,H,G){return this._body.ondoubleclick(F,H,G)},onkeydown:function(F,H,G){return this._body.onkeydown(F,H,G)},onkeyup:function(F,H,G){return this._body.onkeyup(F,H,G)},scrollTo:function(F){window.scrollTo(F.x,F.y);return this},onresize:function(F,H,G){u.add(F,H,G);return this},onscroll:function(F,H,G){B.add(F,H,G);return this},onspin:function(F,H,G){y.add(F,H,G);return this},remove:function(F){u.remove(F);B.remove(F);y.remove(F);this._body.removeEvent(F);return this}};i.ext(h,i.Class);var j=i.coord.zero(),C,m=i.create({div:{"class":"ku-window-disabled"}}),u=i.observer(),B=i.observer(),y=i.observer();var q=function(){};q.prototype={uri:function(F){return this.property("uri",F)},offset:function(F){return this.property("offset",F)},dims:function(F){return this.property("dims",F)},channelmode:function(F){return this.property("channelmode",F)},directories:function(F){return this.property("directories",F)},fullscreen:function(F){return this.property("fullscreen",F)},location:function(F){return this.property("location",F)},menubar:function(F){return this.property("menubar",F)},scrollbars:function(F){return this.property("scrollbars",F)},titlebar:function(F){return this.property("titlebar",F)},toolbar:function(F){return this.property("toolbar",F)},open:function(){}};i.ext(q,i.Class);var A;i.window=function(){if(i.exists(A)){return A}i.evt.add(window,"resize",function(){u.notify()});i.evt.add(window,"scroll",function(){B.notify()});i.evt.add(window,"orientationchange",function(){y.notify()});A=new h();return A};function o(){o.base.call(this);this._onIsValid=i.observer();this._onInvalid=i.observer();this.spec(i.spec(function(){return true})).optional()}o.prototype={$read:function(){return},$write:function(){return},$clear:function(){return},value:function(F){if(!i.exists(F)){return this.$read()}this.$write(F);return this},clear:function(){return this.$clear()},optional:function(){this._optionSpec=i.fields.specs.optional;this._operand="or";return this},required:function(){this._optionSpec=i.fields.specs.required;this._operand="and";return this},spec:function(F){return this.property("spec",F)},isValid:function(){var F=this._optionSpec[this._operand](this.spec()).isSatisfiedBy(this.value()),G=(F)?this._onIsValid:this._onInvalid;G.notify(this);return F},isEmpty:function(){return i.isEmpty(this.value())},onIsValid:function(G,F,H){this._onIsValid.add(G,F,H);return this},onInvalid:function(G,F,H){this._onInvalid.add(G,F,H);return this}};i.ext(o,i.Class);function d(G){d.base.call(this);var F=i.ele(G);this.dom(i.refcheck(F,i.str.format("$.DomClass requires valid DOM node."))).spec(i.spec(function(){return true})).optional()}d.prototype={$read:function(){return this.dom().value},$write:function(F){this.dom().value=F},$clear:function(){this.dom().value="";return this},dom:function(F){return this.property("dom",F)}};i.ext(d,o);i.field=function(F){return new d(F)};i.field.Class=d;function p(F){p.base.call(this,F)}p.prototype={$read:function(){var F=this.dom();return(F.checked)?F.value:""},$write:function(F){var G=this.dom();G.checked=(G.value==F)},$clear:function(){this.uncheck();return this},check:function(){this.dom().checked=true;return this},uncheck:function(){this.dom().checked=false;return this}};i.ext(p,d);i.checkbox=function(F){return new p(F)};i.checkbox.Class=p;function t(){t.base.call(this);this._radios=i.list()}t.prototype={$read:function(){var F=[];this._radios.each(function(G){if(G.checked){F.push(G.value)}});return F.toString()},$write:function(H){var G=(i.isString(H))?H.split(","):H,F=i.list(G);this._radios.each(function(I){I.checked=F.contains(I.value)})},$clear:function(){this._radios.each(function(F){F.checked=false})},add:function(F){this._radios.add(F);return this},listNodes:function(){return this._radios}};i.ext(t,o);i.radioset=function(){return new t()};i.radioset.Class=t;function r(F){r.base.call(this,F);this._opts=function(){return i.list(this.dom().options)};if(this.dom().multiple){this.multiple()}else{this.single()}}r.prototype={$read:function(){var F=[];this._opts().each(function(G){if(G.selected){F.push(G.value)}});return F.toString()},$write:function(F){return(this._multiple)?l(this,F):x(this,F)},multiple:function(){this._multiple=true;return this},single:function(){this._multiple=false;return this},addOptgroup:function(){this.dom().appendChild(document.createElement("optgroup"));return this},addOption:function(G,N,J,L){var H=this.dom(),I=document.createElement("option"),M=J||null,F=(i.exists(M))?H.options[M]:null;I.text=G;I.value=N;if(L){H.getElementsByTagName("optgroup")[J].appendChild(I)}else{try{H.add(I,F)}catch(K){H.add(I,M)}}return this},removeOption:function(F){this.dom().remove(F);return this}};i.ext(r,d);i.select=function(F){return new r(F)};i.select.Class=r;function x(F,G){F._opts().each(function(H){H.selected=(H.value==G)});return F}function l(G,I){var H=(i.isString(I))?I.split(","):I,F=i.list(H);G._opts().each(function(J){J.selected=F.contains(J.value)});return G}function c(){c.base.call(this);this._onSubmit=i.observer();this._fields=i.hash()}c.prototype={$submit:function(){return},name:function(F){return this.property("name",F)},fields:function(){return this._fields},listFields:function(){return this._fields.listValues()},findField:function(F){return this._fields.findValue(F)},isEmpty:function(){var F=true;this._fields.listValues().each(function(G){if(!G.isEmpty()){F=false}});return F},isValid:function(){var F=true;this._fields.listValues().each(function(G){if(!G.isValid()){F=false}});return F},submit:function(){var F=this.read();this._onSubmit.notify(this);this.$submit(F)},onSubmit:function(G,F,H){this._onSubmit.add(G,F,H);return this},add:function(G,F){this._fields.add(G,F);return this},remove:function(F){this._fields.remove(F);return this},clear:function(){this._fields.each(function(F){F.value.clear()});return this},read:function(){var F=i.dto();this._fields.each(function(I){var H=I.key,G=I.value;if(i.exists(G.read)){F.merge(G.read())}if(i.exists(G.value)){F.add(H,G.value())}});return F},write:function(F){if(!i.exists(F)){return this}this._fields.each(function(H){var G=H.value;if(i.exists(G.write)){G.write(F)}if(i.exists(G.value)){G.value(F.find(H.key))}});return this},saveAs:function(F){this.read().saveAs(F);this._name=F;return this},save:function(){var F=this._name||i.uid("form");this.saveAs(F);return F},erase:function(){var F=this._name;if(i.exists(F)){i.dto.serialize(F).erase()}return this},load:function(F){if(i.isString(F)){this._name=F}var G=this._name;return(i.exists(G))?this.write(i.dto.serialize(G)):this}};i.ext(c,i.Class);i.form=function(){return new c()};i.form.Class=c;i.fields={specs:(function(){var F={};try{F.required=i.spec(function(H){return(!i.isNullOrEmpty(H))&&/^.+$/.test(H)}),F.optional=i.spec(function(H){return i.isNullOrEmpty(H)}),F.currency=i.spec(function(H){return/^[\w\$]?(\d+|(\d{1,3}(,\d{3})*))(\.\d{2})?$/.test(H)});F.date=i.spec(function(H){return/^\d{1,2}\/\d{1,2}\/(\d{2}|\d{4})$/.test(H)});F.alpha=i.spec(function(H){return/^[A-Za-z]+$/.test(H)});F.numeric=i.spec(function(H){return/^\d+$/.test(H)});F.alphaNumeric=i.spec(function(H){return/^[A-Za-z\d]+$/.test(H)});F.phone=i.spec(function(H){return/^\d{10,11}|(((1\s)?\(\d{3}\)\s?)|((1\-)?\d{3}\-))\d{3}\-\d{4}$/.test(H)});F.ssn=i.spec(function(H){return/^(\d{9}|(\d{3}\-\d{2}\-\d{4}))$/.test(H)});F.email=i.spec(function(H){return/^\w+(\.\w+)?@\w+(\.\w+)?\.[A-Za-z0-9]{2,}$/.test(H)})}catch(G){}finally{return F}})()};i.ku.localization={en:{day:{name:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},abbr:{0:"Sun",1:"Mon",2:"Tue",3:"Wed",4:"Thu",5:"Fri",6:"Sat"}},month:{name:{1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"},abbr:{1:"Jan",2:"Feb",3:"Mar",4:"Apr",5:"May",6:"Jun",7:"Jul",8:"Aug",9:"Sep",10:"Oct",11:"Nov",12:"Dec"}}},sp:{day:{name:{0:"domingo",1:"lunes",2:"martes",3:"mi&#0233;rcoles",4:"jueves",5:"viernes",6:"s�bado"},abbr:{0:"dom",1:"lun",2:"mar",3:"mi&#0233;",4:"jue",5:"vie",6:"s&#0225;b"}},month:{name:{1:"enero",2:"febrero",3:"marzo",4:"abril",5:"mayo",6:"junio",7:"julio",8:"agosto",9:"septiembre",10:"octubre",11:"noviembre",12:"diciembre"},abbr:{1:"ene",2:"feb",3:"mar",4:"abr",5:"may",6:"jun",7:"jul",8:"ago",9:"sep",10:"oct",11:"nov",12:"dic"}}}};var a=[],g=function(){var H=[],I=this.lazyLoad;function G(){var M=a,K=M.length;while(K--){var J=M[K],L=J.f,O=J.b;try{L()}catch(N){if(O&&I){H[H.length]=L}}}}function F(){var J=H.length;while(J--){var K=H[J];try{K()}catch(L){throw new Error(L)}}}G();if(I){F()}};if(i.ku.browser().isIE){document.onreadystatechange=function(){if(/complete|loaded/.test(document.readyState)){g()}}}else{i.evt.add(document,"DOMContentLoaded",g,i)}})($);